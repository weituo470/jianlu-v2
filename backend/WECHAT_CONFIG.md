# 微信小程序配置说明

## 如何获取微信小程序配置

### 1. 登录微信公众平台
- 访问 [微信公众平台](https://mp.weixin.qq.com/)
- 使用小程序管理员账号登录

### 2. 找到AppID和AppSecret
1. 登录后进入「开发」-「开发管理」
2. 查看「开发设置」页面
3. 找到「开发者ID」部分：
   - **AppID(小程序ID)**: wx3f7821231edc4296 (已配置)
   - **AppSecret(小程序密钥)**: 需要获取

### 3. 获取AppSecret
1. 在「开发设置」页面，找到「AppSecret」
2. 点击「查看」或「重置」
3. 需要管理员扫码验证身份
4. 获取到AppSecret后，将其配置到 `.env` 文件中

### 4. 配置服务器域名
在「开发管理」-「开发设置」-「服务器域名」中配置：
- **request合法域名**: `https://your-domain.com` (生产环境)
- **socket合法域名**: `wss://your-domain.com` (生产环境)

### 5. 更新配置文件

将获取到的AppSecret配置到 `.env` 文件：

```env
# 微信小程序配置
WECHAT_APP_ID=wx3f7821231edc4296
WECHAT_APP_SECRET=your_actual_app_secret_here
```

## 注意事项

1. **AppSecret安全**: 
   - 不要将AppSecret提交到版本控制
   - 定期更换AppSecret
   - 如果怀疑泄露，立即重置

2. **域名配置**:
   - 开发环境可以不校验域名
   - 生产环境必须配置HTTPS域名
   - 域名需要ICP备案

3. **权限配置**:
   - 确保小程序有获取用户信息的权限
   - 检查用户隐私协议配置

## 测试微信登录

配置完成后，可以通过以下步骤测试：

1. 重新启动后端服务
2. 在小程序中点击微信登录
3. 检查后端日志是否有错误
4. 确认用户数据正确保存到数据库

## 常见问题

1. **登录失败**: 检查AppSecret是否正确
2. **code无效**: 检查小程序AppID是否正确
3. **网络错误**: 检查域名配置和网络连接