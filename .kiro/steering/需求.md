<!------------------------------------------------------------------------------------
   Add Rules to this file or a short description and have Kiro refine them for you:   
-------------------------------------------------------------------------------------> # 简庐管理后台系统需求文档

## 1. 项目概述

### 1.1 项目背景
简庐是一个综合性的团队协作和个人日记管理平台，包含Web应用、微信小程序、管理后台等多个组件。本文档定义管理后台系统的功能需求，用于管理整个简庐生态系统的用户、团队、活动等核心数据。

### 1.2 项目目标
- 提供统一的后台管理界面，支持用户、团队、活动的全生命周期管理
- 实现数据统计和分析功能，为运营决策提供支持
- 确保系统安全性和稳定性，支持多角色权限管理
- 提供良好的用户体验和响应式设计

### 1.3 目标用户
- **超级管理员**：负责整个平台的系统管理、用户管理、系统配置等所有功能
- **管理员**：负责日常管理工作，包括用户管理、团队管理、活动管理、内容审核等
- **普通用户**：主要通过小程序端使用系统，参与团队活动、发布日记等

## 2. 功能需求

### 2.1 用户认证与权限管理

#### 2.1.1 用户登录
- **功能描述**：管理员通过用户名/密码登录系统
- **输入**：用户名、密码
- **输出**：登录成功后跳转到仪表板，失败显示错误信息
- **验证规则**：
  - 用户名不能为空
  - 密码不能为空
  - 支持记住登录状态
- **安全要求**：
  - 密码加密传输
  - 登录失败次数限制
  - JWT Token认证

#### 2.1.2 权限控制
- **角色定义**：
  - 超级管理员：拥有所有系统权限，包括用户管理、系统配置、数据分析等
  - 管理员：拥有基本管理权限，包括用户管理、团队管理、活动管理等
  - 普通用户：基本用户权限，主要用于小程序端使用
- **权限控制**：
  - 基于角色的访问控制(RBAC)
  - 页面级权限控制
  - 操作级权限控制

### 2.2 仪表板

#### 2.2.1 数据概览
- **用户统计**：
  - 总用户数
  - 新增用户数（日/周/月）
  - 活跃用户数
  - 用户增长趋势图
- **团队统计**：
  - 总团队数
  - 活跃团队数
  - 平均团队规模
  - 团队活跃度分析
- **活动统计**：
  - 总活动数
  - 进行中活动数
  - 活动参与率
  - 活动类型分布

#### 2.2.2 实时监控
- **系统状态**：
  - 服务器状态
  - 数据库连接状态
  - API响应时间
- **用户活动**：
  - 在线用户数
  - 最近登录用户
  - 异常登录提醒

### 2.3 用户管理

#### 2.3.1 用户列表
- **显示信息**：
  - 用户ID、用户名、昵称、邮箱
  - 注册时间、最后登录时间
  - 用户状态（正常/禁用）
  - 用户角色
- **操作功能**：
  - 搜索用户（用户名、邮箱、昵称）
  - 筛选用户（状态、角色、注册时间）
  - 分页显示
  - 批量操作（启用/禁用/删除）

#### 2.3.2 用户详情
- **基本信息**：
  - 个人资料查看和编辑
  - 头像上传
  - 联系方式管理
- **账户管理**：
  - 密码重置
  - 账户状态修改
  - 角色权限分配
- **活动记录**：
  - 登录历史
  - 操作日志
  - 参与的团队和活动

#### 2.3.3 用户操作
- **新增用户**：
  - 手动创建用户账户
  - 批量导入用户
  - 发送邀请邮件
- **编辑用户**：
  - 修改基本信息
  - 更改用户角色
  - 设置用户权限
- **用户状态管理**：
  - 启用/禁用账户
  - 删除用户（软删除）
  - 恢复已删除用户

### 2.4 团队管理

#### 2.4.1 团队列表
- **显示信息**：
  - 团队ID、团队名称、描述
  - 创建者、创建时间
  - 成员数量、活动数量
  - 团队状态（活跃/非活跃）
- **操作功能**：
  - 搜索团队
  - 筛选团队（状态、创建时间、成员数量）
  - 团队详情查看

#### 2.4.2 团队详情
- **基本信息**：
  - 团队资料查看和编辑
  - 团队头像/封面
  - 团队描述和标签
- **成员管理**：
  - 成员列表显示
  - 添加/移除成员
  - 成员角色管理
  - 成员权限设置
- **活动管理**：
  - 团队活动列表
  - 活动创建和编辑
  - 活动参与统计

#### 2.4.3 团队操作
- **创建团队**：
  - 设置团队基本信息
  - 指定团队管理员
  - 设置团队权限
- **编辑团队**：
  - 修改团队信息
  - 更换团队负责人
  - 调整团队设置
- **团队状态管理**：
  - 激活/停用团队
  - 解散团队
  - 团队合并

### 2.5 活动管理

#### 2.5.1 活动列表
- **显示信息**：
  - 活动ID、活动标题、描述
  - 创建者、所属团队
  - 开始时间、结束时间
  - 参与人数、活动状态
- **操作功能**：
  - 搜索活动
  - 筛选活动（状态、时间、团队）
  - 活动详情查看

#### 2.5.2 活动详情
- **基本信息**：
  - 活动详细信息查看和编辑
  - 活动封面图片
  - 活动地点和时间
- **参与者管理**：
  - 参与者列表
  - 参与统计分析
  - 签到记录管理
- **活动内容**：
  - 活动描述和要求
  - 相关文档和资料
  - 活动反馈收集

#### 2.5.3 活动操作
- **创建活动**：
  - 设置活动基本信息
  - 配置参与规则
  - 设置活动权限
- **编辑活动**：
  - 修改活动信息
  - 调整活动时间
  - 更新活动状态
- **活动状态管理**：
  - 发布/取消活动
  - 活动审核
  - 活动归档

### 2.6 内容管理

#### 2.6.1 日记管理
- **日记列表**：
  - 显示所有用户的日记条目
  - 支持按用户、时间、标签筛选
  - 内容审核状态显示
- **内容审核**：
  - 审核用户发布的日记内容
  - 标记不当内容
  - 内容删除和恢复

#### 2.6.2 评论管理
- **评论列表**：
  - 显示所有评论信息
  - 支持按内容、用户筛选
- **评论审核**：
  - 审核用户评论
  - 删除不当评论
  - 用户举报处理

### 2.7 系统设置

#### 2.7.1 基础配置
- **系统参数**：
  - 系统名称和Logo
  - 联系方式和地址
  - 系统公告管理
- **功能开关**：
  - 用户注册开关
  - 评论功能开关
  - 文件上传限制

#### 2.7.2 安全设置
- **密码策略**：
  - 密码复杂度要求
  - 密码过期时间
  - 登录失败限制
- **访问控制**：
  - IP白名单/黑名单
  - 访问频率限制
  - 安全日志记录

## 3. 非功能需求

### 3.1 性能要求
- **响应时间**：页面加载时间不超过3秒
- **并发用户**：支持100个管理员同时在线
- **数据处理**：支持10万级用户数据管理
- **文件上传**：单文件大小不超过10MB

### 3.2 安全要求
- **数据加密**：敏感数据加密存储
- **传输安全**：HTTPS协议传输
- **访问控制**：基于角色的权限控制
- **审计日志**：完整的操作日志记录

### 3.3 可用性要求
- **系统可用性**：99.5%以上
- **数据备份**：每日自动备份
- **故障恢复**：4小时内恢复服务
- **监控告警**：实时系统监控

### 3.4 兼容性要求
- **浏览器支持**：Chrome、Firefox、Safari、Edge最新版本
- **设备支持**：桌面端和平板端适配
- **分辨率支持**：1366x768及以上分辨率

## 4. 技术要求

### 4.1 前端技术栈
- **框架**：React 18+
- **UI组件库**：Ant Design
- **状态管理**：Redux Toolkit 或 Zustand
- **路由**：React Router
- **HTTP客户端**：Axios
- **构建工具**：Vite

### 4.2 后端技术栈
- **运行环境**：Node.js 18+
- **框架**：Express.js
- **数据库**：MySQL 8.0+
- **认证**：JWT
- **文件存储**：本地存储或云存储
- **日志**：Winston

### 4.3 部署要求
- **容器化**：Docker支持
- **反向代理**：Nginx
- **进程管理**：PM2
- **监控**：系统监控和日志收集

## 5. 界面设计要求

### 5.1 设计原则
- **简洁明了**：界面简洁，操作直观
- **一致性**：保持设计风格统一
- **响应式**：适配不同屏幕尺寸
- **无障碍**：支持键盘导航和屏幕阅读器

### 5.2 布局结构
- **顶部导航**：Logo、用户信息、退出登录
- **侧边菜单**：功能模块导航
- **主内容区**：页面主要内容
- **面包屑导航**：当前位置指示

### 5.3 交互设计
- **加载状态**：数据加载时显示加载动画
- **错误处理**：友好的错误提示信息
- **操作反馈**：操作成功/失败的即时反馈
- **确认对话框**：重要操作前的确认提示

## 6. 数据需求

### 6.1 数据模型
- **用户表**：用户基本信息、认证信息、权限信息
- **团队表**：团队信息、成员关系、权限设置
- **活动表**：活动信息、参与记录、状态管理
- **日记表**：日记内容、标签、审核状态
- **系统表**：配置信息、日志记录、统计数据

### 6.2 数据关系
- 用户与团队：多对多关系
- 用户与活动：多对多关系
- 团队与活动：一对多关系
- 用户与日记：一对多关系

### 6.3 数据安全
- **敏感数据加密**：密码、个人信息
- **数据备份**：定期数据备份
- **访问日志**：记录所有数据访问操作
- **数据脱敏**：导出数据时脱敏处理

## 7. 项目计划

### 7.1 开发阶段
1. **需求分析**（1周）：需求确认、技术选型
2. **系统设计**（1周）：架构设计、数据库设计、接口设计
3. **基础开发**（2周）：项目搭建、基础功能开发
4. **核心功能**（4周）：用户管理、团队管理、活动管理
5. **高级功能**（2周）：数据统计、系统设置、权限管理
6. **测试优化**（2周）：功能测试、性能优化、安全测试
7. **部署上线**（1周）：生产环境部署、监控配置

### 7.2 里程碑
- **M1**：完成项目搭建和基础架构
- **M2**：完成用户认证和权限管理
- **M3**：完成核心业务功能
- **M4**：完成系统测试和优化
- **M5**：完成生产环境部署

## 8. 风险评估

### 8.1 技术风险
- **数据迁移风险**：现有数据迁移可能出现问题
- **性能风险**：大量数据处理可能影响性能
- **安全风险**：权限控制和数据安全需要重点关注

### 8.2 项目风险
- **需求变更风险**：需求可能在开发过程中发生变化
- **时间风险**：开发时间可能超出预期
- **人员风险**：关键开发人员离职风险

### 8.3 风险应对
- **技术风险**：充分的技术调研和原型验证
- **项目风险**：敏捷开发，定期评审和调整
- **人员风险**：知识共享和文档完善

## 9. 验收标准

### 9.1 功能验收
- 所有功能模块按需求正常运行
- 用户界面友好，操作流畅
- 数据处理准确，统计正确
- 权限控制有效，安全可靠

### 9.2 性能验收
- 页面响应时间符合要求
- 系统并发处理能力达标
- 数据库查询性能优良
- 文件上传下载稳定

### 9.3 安全验收
- 通过安全测试
- 权限控制有效
- 数据加密正确
- 日志记录完整

---

**文档版本**：v1.0  
**创建日期**：2024年12月  
**最后更新**：2024年12月  
**文档状态**：待评审