<!DOCTYPE html>
<html>
<head>
    <title>测试轮播图API</title>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
</head>
<body>
    <h1>轮播图API测试</h1>
    <button onclick="testDirectAPI()">直接调用API</button>
    <button onclick="testWindowAPI()">通过window.API调用</button>
    <button onclick="testFetch()">使用Fetch调用</button>
    
    <div id="result" style="margin-top: 20px;"></div>

    <script>
        async function testDirectAPI() {
            document.getElementById('result').innerHTML = '<p>测试直接API调用...</p>';
            try {
                const response = await API.banners.getList();
                console.log('直接API响应:', response);
                document.getElementById('result').innerHTML = `
                    <h3>直接API调用结果:</h3>
                    <pre>${JSON.stringify(response, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('直接API错误:', error);
                document.getElementById('result').innerHTML = `
                    <h3>直接API调用失败:</h3>
                    <p style="color: red;">${error.message}</p>
                `;
            }
        }

        async function testWindowAPI() {
            document.getElementById('result').innerHTML = '<p>测试window.API调用...</p>';
            try {
                const response = await window.API.banners.getList();
                console.log('window.API响应:', response);
                document.getElementById('result').innerHTML = `
                    <h3>window.API调用结果:</h3>
                    <pre>${JSON.stringify(response, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('window.API错误:', error);
                document.getElementById('result').innerHTML = `
                    <h3>window.API调用失败:</h3>
                    <p style="color: red;">${error.message}</p>
                `;
            }
        }

        async function testFetch() {
            document.getElementById('result').innerHTML = '<p>测试Fetch调用...</p>';
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${AppConfig.API_BASE_URL}/banners`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                console.log('Fetch response status:', response.status);
                const data = await response.json();
                console.log('Fetch响应:', data);
                
                document.getElementById('result').innerHTML = `
                    <h3>Fetch调用结果:</h3>
                    <p>状态码: ${response.status}</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('Fetch错误:', error);
                document.getElementById('result').innerHTML = `
                    <h3>Fetch调用失败:</h3>
                    <p style="color: red;">${error.message}</p>
                `;
            }
        }

        // 页面加载时显示基本信息
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成');
            console.log('AppConfig:', AppConfig);
            console.log('API对象:', typeof window.API, window.API);
            console.log('Token:', localStorage.getItem('token') ? '有' : '无');
        });
    </script>
</body>
</html>