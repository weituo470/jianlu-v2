<!DOCTYPE html>
<html>
<head>
    <title>验证 API.upload 修复</title>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
</head>
<body>
    <h1>验证 API.upload 修复</h1>
    
    <button onclick="checkAPI()">检查 API 对象</button>
    <div id="result"></div>

    <script>
        function checkAPI() {
            const result = document.getElementById('result');
            let html = '<h3>API 对象检查结果:</h3><ul>';
            
            html += `<li>window.API: ${typeof window.API}</li>`;
            html += `<li>window.API.upload: ${typeof window.API?.upload}</li>`;
            html += `<li>window.API.fileUpload: ${typeof window.API?.fileUpload}</li>`;
            html += `<li>window.API.banners: ${typeof window.API?.banners}</li>`;
            html += `<li>window.API.banners.create: ${typeof window.API?.banners?.create}</li>`;
            
            // 测试 upload 函数是否可调用
            if (typeof window.API?.upload === 'function') {
                html += '<li style="color: green;">✅ window.API.upload 是函数，可以调用</li>';
            } else {
                html += '<li style="color: red;">❌ window.API.upload 不是函数</li>';
            }
            
            html += '</ul>';
            result.innerHTML = html;
            
            console.log('API对象:', window.API);
        }
        
        // 页面加载完成后自动检查
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkAPI, 100);
        });
    </script>
</body>
</html>