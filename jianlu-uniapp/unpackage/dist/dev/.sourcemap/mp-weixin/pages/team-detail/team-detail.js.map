{"version":3,"file":"team-detail.js","sources":["pages/team-detail/team-detail.vue","../../../HBuilderX.4.56.2025031210/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVhbS1kZXRhaWwvdGVhbS1kZXRhaWwudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"team-detail-container\">\r\n\t\t<!-- 页面头部 -->\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"team-info\">\r\n\t\t\t\t<view class=\"team-avatar\">\r\n\t\t\t\t\t{{ teamInfo.name ? teamInfo.name.charAt(0) : 'T' }}\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"team-meta\">\r\n\t\t\t\t\t<text class=\"team-name\">{{ teamInfo.name || '团队详情' }}</text>\r\n\t\t\t\t\t<text class=\"member-count\">👥 {{ teamInfo.member_count || 0 }} 成员</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 团队描述 -->\r\n\t\t<view class=\"description-section card\" v-if=\"teamInfo.description\">\r\n\t\t\t<view class=\"section-title\">团队介绍</view>\r\n\t\t\t<text class=\"description-text\">{{ teamInfo.description }}</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 团队成员列表 -->\r\n\t\t<view class=\"members-section card\">\r\n\t\t\t<view class=\"section-header\">\r\n\t\t\t\t<text class=\"section-title\">团队成员</text>\r\n\t\t\t\t<text class=\"member-total\">{{ members.length }}人</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 加载状态 -->\r\n\t\t\t<view v-if=\"loading\" class=\"loading-state\">\r\n\t\t\t\t<text>加载中...</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 成员列表 -->\r\n\t\t\t<view v-else-if=\"members.length > 0\" class=\"member-list\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"member-item\" \r\n\t\t\t\t\tv-for=\"member in members\" \r\n\t\t\t\t\t:key=\"member.id\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<view class=\"member-avatar\">\r\n\t\t\t\t\t\t<image \r\n\t\t\t\t\t\t\tv-if=\"member.avatar && member.avatar !== '/images/default-avatar.png'\" \r\n\t\t\t\t\t\t\t:src=\"member.avatar\" \r\n\t\t\t\t\t\t\tmode=\"aspectFill\"\r\n\t\t\t\t\t\t\tclass=\"avatar-image\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<text v-else class=\"avatar-text\">\r\n\t\t\t\t\t\t\t{{ member.nickname ? member.nickname.charAt(0) : '?' }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"member-info\">\r\n\t\t\t\t\t\t<view class=\"member-name-row\">\r\n\t\t\t\t\t\t\t<text class=\"member-name\">{{ member.nickname }}</text>\r\n\t\t\t\t\t\t\t<view class=\"role-badge\" :class=\"member.is_leader ? 'leader' : 'member'\">\r\n\t\t\t\t\t\t\t\t<text class=\"role-icon\" v-if=\"member.is_leader\">👑</text>\r\n\t\t\t\t\t\t\t\t<text class=\"role-text\">{{ member.role_name }}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<text class=\"join-time\">{{ formatJoinTime(member.joined_at) }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 空状态 -->\r\n\t\t\t<view v-else class=\"empty-state\">\r\n\t\t\t\t<text>暂无成员信息</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 团队操作 -->\r\n\t\t<view class=\"actions-section card\" v-if=\"isLeader\">\r\n\t\t\t<button class=\"action-btn primary\" @tap=\"viewApplications\">\r\n\t\t\t\t<text class=\"btn-icon\">📋</text>\r\n\t\t\t\t<text class=\"btn-text\">申请管理</text>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { groupApi } from '../../api/index.js'\r\nimport { showError, showSuccess, formatDate } from '../../utils/index.js'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tteamId: null,\r\n\t\t\tteamInfo: {},\r\n\t\t\tmembers: [],\r\n\t\t\tloading: false,\r\n\t\t\tisLeader: false\r\n\t\t}\r\n\t},\r\n\t\r\n\tonLoad(options) {\r\n\t\tif (options.id) {\r\n\t\t\tthis.teamId = parseInt(options.id)\r\n\t\t\tthis.loadTeamDetail()\r\n\t\t\tthis.loadTeamMembers()\r\n\t\t}\r\n\t},\r\n\t\r\n\tmethods: {\r\n\t\t// 加载团队详情\r\n\t\tasync loadTeamDetail() {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await groupApi.getTeamDetail(this.teamId)\r\n\t\t\t\tif (response.success) {\r\n\t\t\t\t\tthis.teamInfo = response.data\r\n\t\t\t\t\t// 设置页面标题\r\n\t\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\t\ttitle: this.teamInfo.name || '团队详情'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('加载团队详情失败:', error)\r\n\t\t\t\tshowError('加载团队详情失败')\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 加载团队成员列表\r\n\t\tasync loadTeamMembers() {\r\n\t\t\tthis.loading = true\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await groupApi.getTeamMembers(this.teamId)\r\n\t\t\t\tif (response.success) {\r\n\t\t\t\t\tthis.members = response.data.members || []\r\n\t\t\t\t\tthis.teamInfo.member_count = response.data.total_members || this.members.length\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 检查当前用户是否是负责人\r\n\t\t\t\t\tconst currentUser = uni.getStorageSync('userInfo')\r\n\t\t\t\t\tif (currentUser) {\r\n\t\t\t\t\t\tthis.isLeader = this.members.some(member => \r\n\t\t\t\t\t\t\tmember.id === currentUser.id && member.is_leader\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('加载团队成员失败:', error)\r\n\t\t\t\tshowError('加载成员列表失败')\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 格式化加入时间\r\n\t\tformatJoinTime(dateStr) {\r\n\t\t\tif (!dateStr) return '未知'\r\n\t\t\ttry {\r\n\t\t\t\tconst date = new Date(dateStr)\r\n\t\t\t\tconst now = new Date()\r\n\t\t\t\tconst diffTime = now - date\r\n\t\t\t\tconst diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24))\r\n\t\t\t\t\r\n\t\t\t\tif (diffDays === 0) {\r\n\t\t\t\t\treturn '今天加入'\r\n\t\t\t\t} else if (diffDays === 1) {\r\n\t\t\t\t\treturn '昨天加入'\r\n\t\t\t\t} else if (diffDays < 30) {\r\n\t\t\t\t\treturn `${diffDays}天前加入`\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn formatDate(dateStr, 'YYYY年MM月DD日')\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\treturn '未知'\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 查看申请管理\r\n\t\tviewApplications() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/team-applications/team-applications?teamId=${this.teamId}&teamName=${encodeURIComponent(this.teamInfo.name)}`\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.team-detail-container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.header {\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tborder-radius: 16rpx;\r\n\tpadding: 40rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tcolor: white;\r\n}\r\n\r\n.team-info {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n}\r\n\r\n.team-avatar {\r\n\twidth: 120rpx;\r\n\theight: 120rpx;\r\n\tborder-radius: 60rpx;\r\n\tbackground-color: rgba(255, 255, 255, 0.2);\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 48rpx;\r\n\tfont-weight: bold;\r\n\tmargin-right: 30rpx;\r\n}\r\n\r\n.team-meta {\r\n\tflex: 1;\r\n}\r\n\r\n.team-name {\r\n\tdisplay: block;\r\n\tfont-size: 36rpx;\r\n\tfont-weight: bold;\r\n\tmargin-bottom: 10rpx;\r\n\tline-height: 1.3;\r\n\tword-wrap: break-word;\r\n\tword-break: break-all;\r\n}\r\n\r\n.member-count {\r\n\tfont-size: 28rpx;\r\n\topacity: 0.9;\r\n}\r\n\r\n.card {\r\n\tbackground-color: white;\r\n\tborder-radius: 16rpx;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tbox-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.section-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.section-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.member-total {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666;\r\n}\r\n\r\n.description-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666;\r\n\tline-height: 1.6;\r\n\tword-wrap: break-word;\r\n\tword-break: break-all;\r\n}\r\n\r\n.member-list {\r\n\t.member-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx 0;\r\n\t\tborder-bottom: 1rpx solid #f0f0f0;\r\n\t\t\r\n\t\t&:last-child {\r\n\t\t\tborder-bottom: none;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.member-avatar {\r\n\twidth: 80rpx;\r\n\theight: 80rpx;\r\n\tborder-radius: 50%;\r\n\tmargin-right: 24rpx;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\tbackground-color: #f0f0f0;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n\r\n.avatar-image {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n.avatar-text {\r\n\tfont-size: 32rpx;\r\n\tcolor: #666;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.member-info {\r\n\tflex: 1;\r\n}\r\n\r\n.member-name-row {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.member-name {\r\n\tfont-size: 30rpx;\r\n\tcolor: #333;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.role-badge {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 4rpx 12rpx;\r\n\tborder-radius: 12rpx;\r\n\tfont-size: 24rpx;\r\n\t\r\n\t&.leader {\r\n\t\tbackground-color: #fff3cd;\r\n\t\tcolor: #856404;\r\n\t}\r\n\t\r\n\t&.member {\r\n\t\tbackground-color: #e7f3ff;\r\n\t\tcolor: #0066cc;\r\n\t}\r\n}\r\n\r\n.role-icon {\r\n\tmargin-right: 4rpx;\r\n}\r\n\r\n.join-time {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.loading-state, .empty-state {\r\n\ttext-align: center;\r\n\tpadding: 60rpx 0;\r\n\tcolor: #999;\r\n\tfont-size: 28rpx;\r\n}\r\n\r\n.actions-section {\r\n\t.action-btn {\r\n\t\twidth: 100%;\r\n\t\theight: 88rpx;\r\n\t\tborder-radius: 44rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-size: 32rpx;\r\n\t\tborder: none;\r\n\t\t\r\n\t\t&.primary {\r\n\t\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\t\t\tcolor: white;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.btn-icon {\r\n\t\tmargin-right: 12rpx;\r\n\t}\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/D/re/kirojianlu/jianlu-uniapp/pages/team-detail/team-detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["groupApi","uni","showError","formatDate"],"mappings":";;;;AAqFA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,QAAQ;AAAA,MACR,UAAU,CAAE;AAAA,MACZ,SAAS,CAAE;AAAA,MACX,SAAS;AAAA,MACT,UAAU;AAAA,IACX;AAAA,EACA;AAAA,EAED,OAAO,SAAS;AACf,QAAI,QAAQ,IAAI;AACf,WAAK,SAAS,SAAS,QAAQ,EAAE;AACjC,WAAK,eAAe;AACpB,WAAK,gBAAgB;AAAA,IACtB;AAAA,EACA;AAAA,EAED,SAAS;AAAA;AAAA,IAER,MAAM,iBAAiB;AACtB,UAAI;AACH,cAAM,WAAW,MAAMA,UAAAA,SAAS,cAAc,KAAK,MAAM;AACzD,YAAI,SAAS,SAAS;AACrB,eAAK,WAAW,SAAS;AAEzBC,wBAAAA,MAAI,sBAAsB;AAAA,YACzB,OAAO,KAAK,SAAS,QAAQ;AAAA,WAC7B;AAAA,QACF;AAAA,MACC,SAAO,OAAO;AACfA,sBAAAA,MAAA,MAAA,SAAA,4CAAc,aAAa,KAAK;AAChCC,oBAAAA,UAAU,UAAU;AAAA,MACrB;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,kBAAkB;AACvB,WAAK,UAAU;AACf,UAAI;AACH,cAAM,WAAW,MAAMF,UAAAA,SAAS,eAAe,KAAK,MAAM;AAC1D,YAAI,SAAS,SAAS;AACrB,eAAK,UAAU,SAAS,KAAK,WAAW,CAAC;AACzC,eAAK,SAAS,eAAe,SAAS,KAAK,iBAAiB,KAAK,QAAQ;AAGzE,gBAAM,cAAcC,cAAAA,MAAI,eAAe,UAAU;AACjD,cAAI,aAAa;AAChB,iBAAK,WAAW,KAAK,QAAQ;AAAA,cAAK,YACjC,OAAO,OAAO,YAAY,MAAM,OAAO;AAAA,YACxC;AAAA,UACD;AAAA,QACD;AAAA,MACC,SAAO,OAAO;AACfA,sBAAAA,MAAA,MAAA,SAAA,4CAAc,aAAa,KAAK;AAChCC,oBAAAA,UAAU,UAAU;AAAA,MACrB,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA,IAGD,eAAe,SAAS;AACvB,UAAI,CAAC;AAAS,eAAO;AACrB,UAAI;AACH,cAAM,OAAO,IAAI,KAAK,OAAO;AAC7B,cAAM,MAAM,oBAAI,KAAK;AACrB,cAAM,WAAW,MAAM;AACvB,cAAM,WAAW,KAAK,MAAM,YAAY,MAAO,KAAK,KAAK,GAAG;AAE5D,YAAI,aAAa,GAAG;AACnB,iBAAO;AAAA,QACR,WAAW,aAAa,GAAG;AAC1B,iBAAO;AAAA,QACR,WAAW,WAAW,IAAI;AACzB,iBAAO,GAAG,QAAQ;AAAA,eACZ;AACN,iBAAOC,YAAU,WAAC,SAAS,aAAa;AAAA,QACzC;AAAA,MACC,SAAO,OAAO;AACf,eAAO;AAAA,MACR;AAAA,IACA;AAAA;AAAA,IAGD,mBAAmB;AAClBF,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qDAAqD,KAAK,MAAM,aAAa,mBAAmB,KAAK,SAAS,IAAI,CAAC;AAAA,OACxH;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChLA,GAAG,WAAW,eAAe;"}