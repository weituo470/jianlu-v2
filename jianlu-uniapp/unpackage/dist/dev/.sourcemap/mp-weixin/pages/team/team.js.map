{"version":3,"file":"team.js","sources":["pages/team/team.vue","../../../HBuilderX.4.56.2025031210/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVhbS90ZWFtLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"team-container\">\n\t\t<!-- 页面头部 -->\n\t\t<view class=\"header\">\n\t\t\t<view class=\"title-section\">\n\t\t\t\t<text class=\"page-title\">我的团队</text>\n\t\t\t\t<text class=\"page-subtitle\">与团队成员一起协作</text>\n\t\t\t</view>\n\t\t\t<view class=\"header-actions\">\n\t\t\t\t<button class=\"browse-btn\" @tap=\"browseTeams\">\n\t\t\t\t\t<text class=\"browse-icon\">🔍</text>\n\t\t\t\t</button>\n\t\t\t\t<button class=\"add-btn\" @tap=\"showCreateModal\">\n\t\t\t\t\t<text class=\"add-icon\">+</text>\n\t\t\t\t</button>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 群组列表 -->\n\t\t<view class=\"group-list\" v-if=\"groups.length > 0\">\n\t\t\t<view \n\t\t\t\tclass=\"group-item card\" \n\t\t\t\tv-for=\"group in groups\" \n\t\t\t\t:key=\"group.id\"\n\t\t\t\t@tap=\"viewGroup(group)\"\n\t\t\t>\n\t\t\t\t<view class=\"group-header\">\n\t\t\t\t\t<view class=\"group-avatar\">\n\t\t\t\t\t\t{{ group.name.charAt(0) }}\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"group-info\">\n\t\t\t\t\t\t<text class=\"group-name\">{{ group.name }}</text>\n\t\t\t\t\t\t<view class=\"group-meta\">\n\t\t\t\t\t\t\t<text class=\"member-count\">👥 {{ group.member_count }} 成员</text>\n\t\t\t\t\t\t\t<text class=\"role-badge\" :class=\"group.role\">\n\t\t\t\t\t\t\t\t<text class=\"role-icon\" v-if=\"group.role === 'admin'\">👑</text>\n\t\t\t\t\t\t\t\t{{ group.role === 'admin' ? '负责人' : '成员' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"group-actions\" v-if=\"group.role === 'admin'\">\n\t\t\t\t\t\t<text class=\"action-btn\">⚙️</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"group-description\" v-if=\"group.description\">\n\t\t\t\t\t{{ group.description }}\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"group-footer\">\n\t\t\t\t\t<text class=\"join-date\">\n\t\t\t\t\t\t加入时间: {{ formatDate(group.joined_at, 'YYYY-MM-DD') }}\n\t\t\t\t\t</text>\n\t\t\t\t\t<button class=\"btn btn-outline small\" @tap.stop=\"viewActivities(group)\">\n\t\t\t\t\t\t📅 查看活动\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 空状态 -->\n\t\t<view class=\"empty-state\" v-else-if=\"!loading\">\n\t\t\t<text class=\"empty-icon\">👥</text>\n\t\t\t<text class=\"empty-title\">还没有团队</text>\n\t\t\t<text class=\"empty-subtitle\">创建或加入一个团队，开始组织活动吧！</text>\n\t\t\t<button class=\"btn btn-primary\" @tap=\"showCreateModal\">创建第一个团队</button>\n\t\t</view>\n\t\t\n\t\t<!-- 加载状态 -->\n\t\t<view class=\"loading-state\" v-if=\"loading\">\n\t\t\t<text>加载中...</text>\n\t\t</view>\n\t\t\n\t\t<!-- 创建团队弹窗 -->\n\t\t<view class=\"modal-overlay\" v-if=\"showModal\" @tap=\"hideModal\">\n\t\t\t<view class=\"modal-content\" @tap.stop>\n\t\t\t\t<view class=\"modal-header\">\n\t\t\t\t\t<text class=\"modal-title\">创建团队</text>\n\t\t\t\t\t<text class=\"modal-close\" @tap=\"hideModal\">×</text>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"modal-body\">\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">团队名称 <text class=\"required\">*</text></text>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"input\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"输入团队名称（2-50个字符）\"\n\t\t\t\t\t\t\tv-model=\"groupForm.name\"\n\t\t\t\t\t\t\t:maxlength=\"50\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">团队类型</text>\n\t\t\t\t\t\t<picker \n\t\t\t\t\t\t\t:range=\"teamTypes\" \n\t\t\t\t\t\t\t:range-key=\"'label'\"\n\t\t\t\t\t\t\t:value=\"teamTypeIndex\"\n\t\t\t\t\t\t\t@change=\"onTeamTypeChange\"\n\t\t\t\t\t\t\tclass=\"picker\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"picker-display\">\n\t\t\t\t\t\t\t\t{{ getSelectedTeamTypeName() }}\n\t\t\t\t\t\t\t\t<text class=\"picker-arrow\">▼</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</picker>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">团队描述</text>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tclass=\"textarea\"\n\t\t\t\t\t\t\tplaceholder=\"描述一下这个团队的用途（可选，最多500字符）\"\n\t\t\t\t\t\t\tv-model=\"groupForm.description\"\n\t\t\t\t\t\t\t:maxlength=\"500\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">团队头像</text>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclass=\"input\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"输入头像URL（可选）\"\n\t\t\t\t\t\t\tv-model=\"groupForm.avatar_url\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<text class=\"form-hint\">可以输入图片链接作为团队头像</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"modal-footer\">\n\t\t\t\t\t<button class=\"btn btn-secondary\" @tap=\"hideModal\">取消</button>\n\t\t\t\t\t<button class=\"btn btn-primary\" @tap=\"createGroup\" :disabled=\"saving\">\n\t\t\t\t\t\t{{ saving ? '创建中...' : '创建' }}\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 团队详情弹窗 -->\n\t\t<view class=\"modal-overlay\" v-if=\"showDetailModal\" @tap=\"hideDetailModal\">\n\t\t\t<view class=\"modal-content\" @tap.stop>\n\t\t\t\t<view class=\"modal-header\">\n\t\t\t\t\t<text class=\"modal-title\">{{ selectedGroup?.name }}</text>\n\t\t\t\t\t<text class=\"modal-close\" @tap=\"hideDetailModal\">×</text>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"modal-body\" v-if=\"selectedGroup\">\n\t\t\t\t\t<view class=\"detail-section\">\n\t\t\t\t\t\t<text class=\"detail-label\">团队描述</text>\n\t\t\t\t\t\t<text class=\"detail-value\">{{ selectedGroup.description || '暂无描述' }}</text>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view class=\"detail-section\">\n\t\t\t\t\t\t<text class=\"detail-label\">成员（{{ selectedGroup.member_count }}）</text>\n\t\t\t\t\t\t<view class=\"members-preview\">\n\t\t\t\t\t\t\t<view class=\"member-list-preview\">\n\t\t\t\t\t\t\t\t<!-- 如果有成员预览数据，显示实际成员 -->\n\t\t\t\t\t\t\t\t<template v-if=\"selectedGroup.membersPreview && selectedGroup.membersPreview.length > 0\">\n\t\t\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\t\t\tv-for=\"(member, index) in selectedGroup.membersPreview\"\n\t\t\t\t\t\t\t\t\t\t:key=\"member.id\"\n\t\t\t\t\t\t\t\t\t\tclass=\"member-item\"\n\t\t\t\t\t\t\t\t\t\t:class=\"{ 'leader': member.is_leader }\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ member.is_leader ? '👑' : '👤' }} {{ member.nickname }}\n\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- 如果没有预览数据，显示默认信息 -->\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<text class=\"member-item leader\" v-if=\"selectedGroup.role === 'admin'\">\n\t\t\t\t\t\t\t\t\t\t👑 {{ selectedGroup.leader_name || '我' }}\n\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t\t<text class=\"member-item\" v-if=\"selectedGroup.member_count > 1\">\n\t\t\t\t\t\t\t\t\t\t👤 其他成员\n\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t\t<!-- 如果成员超过4个，显示省略号 -->\n\t\t\t\t\t\t\t\t<text v-if=\"selectedGroup.member_count > 4\" class=\"member-more\">...</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<text class=\"view-all-members\" @tap=\"viewTeamDetail(selectedGroup)\">查看全部成员</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view class=\"detail-section\">\n\t\t\t\t\t\t<text class=\"detail-label\">我的角色</text>\n\t\t\t\t\t\t<text class=\"detail-value\">\n\t\t\t\t\t\t\t<text v-if=\"selectedGroup.role === 'admin'\">👑 负责人</text>\n\t\t\t\t\t\t\t<text v-else>👤 成员</text>\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<view class=\"detail-section\">\n\t\t\t\t\t\t<text class=\"detail-label\">加入时间</text>\n\t\t\t\t\t\t<text class=\"detail-value\">{{ formatDate(selectedGroup.joined_at, 'YYYY年MM月DD日') }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"modal-footer\">\n\t\t\t\t\t<view class=\"action-buttons\">\n\t\t\t\t\t\t<button class=\"action-btn\" @tap=\"viewTeamDetail(selectedGroup)\">\n\t\t\t\t\t\t\t团队详情\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button class=\"action-btn\" @tap=\"viewActivities(selectedGroup)\">\n\t\t\t\t\t\t\t团队活动\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"action-btn\"\n\t\t\t\t\t\t\t@tap=\"viewApplications(selectedGroup)\"\n\t\t\t\t\t\t\tv-if=\"selectedGroup.role === 'admin' || selectedGroup.role === 'leader'\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t处理申请\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</view>\n\n\t\t\t\t\t<!-- 只有非负责人才显示退出按钮 -->\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn btn-danger exit-btn\"\n\t\t\t\t\t\t@tap=\"leaveGroup(selectedGroup)\"\n\t\t\t\t\t\tv-if=\"selectedGroup.role !== 'admin' && selectedGroup.role !== 'leader'\"\n\t\t\t\t\t>\n\t\t\t\t\t\t退出团队\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport { groupApi } from '../../api/index.js'\n\timport { formatDate, showSuccess, showError, showConfirm } from '../../utils/index.js'\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tgroups: [],\n\t\t\t\tteamTypes: [\n\t\t\t\t\t{ value: 'general', label: '通用团队' }\n\t\t\t\t], // 团队类型列表，初始化默认值\n\t\t\t\tloading: false,\n\t\t\t\tshowModal: false,\n\t\t\t\tshowDetailModal: false,\n\t\t\t\tsaving: false,\n\t\t\t\tselectedGroup: null,\n\t\t\t\tgroupForm: {\n\t\t\t\t\tname: '',\n\t\t\t\t\tdescription: '',\n\t\t\t\t\tteam_type: 'general',\n\t\t\t\t\tavatar_url: ''\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\t// 计算团队类型选择器的索引\n\t\t\tteamTypeIndex() {\n\t\t\t\tif (!this.teamTypes || this.teamTypes.length === 0) {\n\t\t\t\t\treturn 0\n\t\t\t\t}\n\t\t\t\tconst index = this.teamTypes.findIndex(t => t.value === this.groupForm.team_type)\n\t\t\t\treturn index >= 0 ? index : 0\n\t\t\t}\n\t\t},\n\t\tonLoad() {\n\t\t\tthis.loadInitialData()\n\t\t},\n\t\tonShow() {\n\t\t\tthis.loadInitialData()\n\t\t},\n\t\tonPullDownRefresh() {\n\t\t\tthis.fetchGroups().finally(() => {\n\t\t\t\tuni.stopPullDownRefresh()\n\t\t\t})\n\t\t},\n\t\tmethods: {\n\t\t\tformatDate,\n\t\t\t\n\t\t\t// 加载初始数据\n\t\t\tasync loadInitialData() {\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.fetchGroups(),\n\t\t\t\t\tthis.loadTeamTypes()\n\t\t\t\t])\n\t\t\t},\n\n\t\t\t// 加载团队类型\n\t\t\tasync loadTeamTypes() {\n\t\t\t\ttry {\n\t\t\t\t\t// 从后台API获取团队类型\n\t\t\t\t\tconst response = await groupApi.getTeamTypes()\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tthis.teamTypes = response.data || []\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('加载团队类型失败:', error)\n\t\t\t\t\t// 使用默认类型\n\t\t\t\t\tthis.teamTypes = [\n\t\t\t\t\t\t{ value: 'general', label: '通用团队' }\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 获取团队列表\n\t\t\tasync fetchGroups() {\n\t\t\t\tthis.loading = true\n\t\t\t\ttry {\n\t\t\t\t\t// 调用我的团队API，获取用户已加入的团队\n\t\t\t\t\tconst response = await groupApi.getMyTeams()\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t// 修复：团队数据在 response.data.teams 中\n\t\t\t\t\t\tconst teams = response.data.teams || response.data || []\n\t\t\t\t\t\tthis.groups = Array.isArray(teams) ? teams : []\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tshowError('获取团队列表失败')\n\t\t\t\t\tconsole.error('获取团队列表失败:', error)\n\t\t\t\t} finally {\n\t\t\t\t\tthis.loading = false\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 显示创建弹窗\n\t\t\tshowCreateModal() {\n\t\t\t\tthis.resetForm()\n\t\t\t\tthis.showModal = true\n\t\t\t},\n\t\t\t\n\t\t\t// 隐藏创建弹窗\n\t\t\thideModal() {\n\t\t\t\tthis.showModal = false\n\t\t\t\tthis.resetForm()\n\t\t\t},\n\t\t\t\n\t\t\t// 重置表单\n\t\t\tresetForm() {\n\t\t\t\tthis.groupForm = {\n\t\t\t\t\tname: '',\n\t\t\t\t\tdescription: '',\n\t\t\t\t\tteam_type: 'general',\n\t\t\t\t\tavatar_url: ''\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 创建团队\n\t\t\tasync createGroup() {\n\t\t\t\t// 表单验证\n\t\t\t\tif (!this.groupForm.name.trim()) {\n\t\t\t\t\tshowError('请输入团队名称')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tif (this.groupForm.name.trim().length < 2) {\n\t\t\t\t\tshowError('团队名称至少2个字符')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tif (this.groupForm.name.trim().length > 50) {\n\t\t\t\t\tshowError('团队名称不能超过50个字符')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tif (this.groupForm.description && this.groupForm.description.length > 500) {\n\t\t\t\t\tshowError('团队描述不能超过500个字符')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tthis.saving = true\n\t\t\t\ttry {\n\t\t\t\t\tconst data = {\n\t\t\t\t\t\tname: this.groupForm.name.trim(),\n\t\t\t\t\t\tdescription: this.groupForm.description?.trim() || '',\n\t\t\t\t\t\tteam_type: this.groupForm.team_type || 'general',\n\t\t\t\t\t\tavatar_url: this.groupForm.avatar_url?.trim() || null\n\t\t\t\t\t}\n\n\t\t\t\t\tconst response = await groupApi.create(data)\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tshowSuccess('团队创建成功')\n\t\t\t\t\t\tthis.hideModal()\n\t\t\t\t\t\tthis.fetchGroups()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(response.message || '创建失败')\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('创建团队失败:', error)\n\t\t\t\t\tshowError(error.message || '创建失败，请稍后重试')\n\t\t\t\t} finally {\n\t\t\t\t\tthis.saving = false\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 查看团队详情\n\t\t\tasync viewGroup(group) {\n\t\t\t\tthis.selectedGroup = group\n\t\t\t\t// 获取团队成员预览信息\n\t\t\t\tawait this.loadTeamMembersPreview(group.id)\n\t\t\t\tthis.showDetailModal = true\n\t\t\t},\n\n\t\t\t// 隐藏详情弹窗\n\t\t\thideDetailModal() {\n\t\t\t\tthis.showDetailModal = false\n\t\t\t\tthis.selectedGroup = null\n\t\t\t},\n\n\t\t\t// 查看团队活动\n\t\t\tviewActivities(group) {\n\t\t\t\tthis.hideDetailModal()\n\t\t\t\tuni.switchTab({\n\t\t\t\t\turl: `/pages/activity/activity?groupId=${group.id}`\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// 离开群组\n\t\t\tasync leaveGroup(group) {\n\t\t\t\t// 检查用户角色\n\t\t\t\tif (group.role === 'admin' || group.role === 'leader') {\n\t\t\t\t\tshowError('团队负责人不能退出团队，请先转让负责人权限')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tconst confirmed = await showConfirm(`确定要离开群组\"${group.name}\"吗？`)\n\t\t\t\tif (!confirmed) return\n\n\t\t\t\ttry {\n\t\t\t\t\tawait groupApi.leave(group.id)\n\t\t\t\t\tshowSuccess('已离开群组')\n\t\t\t\t\tthis.hideDetailModal()\n\t\t\t\t\tthis.fetchGroups()\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('离开群组失败:', error)\n\n\t\t\t\t\t// 根据错误类型提供不同的提示\n\t\t\t\t\tif (error.message && error.message.includes('负责人')) {\n\t\t\t\t\t\tshowError('团队负责人不能退出团队，请先转让负责人权限')\n\t\t\t\t\t} else if (error.message && error.message.includes('不在该团队中')) {\n\t\t\t\t\t\tshowError('您不在该团队中，请刷新页面')\n\t\t\t\t\t\t// 自动刷新团队列表\n\t\t\t\t\t\tthis.fetchGroups()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshowError('离开群组失败，请稍后重试')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 浏览团队\n\t\t\tbrowseTeams() {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/team-browse/team-browse'\n\t\t\t\t})\n\t\t\t},\n\n\t\t\t// 查看申请管理\n\t\t\tviewApplications(group) {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: `/pages/team-applications/team-applications?teamId=${group.id}&teamName=${encodeURIComponent(group.name)}`\n\t\t\t\t})\n\t\t\t},\n\n\t\t\t// 查看团队详情和成员列表\n\t\t\tviewTeamDetail(group) {\n\t\t\t\tthis.hideDetailModal()\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: `/pages/team-detail/team-detail?id=${group.id}`\n\t\t\t\t})\n\t\t\t},\n\n\t\t\t// 加载团队成员预览（前4个成员）\n\t\t\tasync loadTeamMembersPreview(teamId) {\n\t\t\t\ttry {\n\t\t\t\t\t// 所有用户都可以获取成员列表\n\t\t\t\t\tconst response = await groupApi.getTeamMembers(teamId)\n\t\t\t\t\tif (response.success && response.data.members) {\n\t\t\t\t\t\t// 取前4个成员用于预览\n\t\t\t\t\t\tthis.selectedGroup.membersPreview = response.data.members.slice(0, 4)\n\t\t\t\t\t\tthis.selectedGroup.leader_name = response.data.members.find(m => m.is_leader)?.nickname || '负责人'\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log('获取成员预览失败:', error)\n\t\t\t\t\t// 如果获取失败，使用默认显示\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// 团队类型选择相关方法\n\t\t\tonTeamTypeChange(e) {\n\t\t\t\tconst index = e.detail.value\n\t\t\t\tthis.groupForm.team_type = this.teamTypes[index].value\n\t\t\t},\n\n\t\t\tgetSelectedTeamTypeName() {\n\t\t\t\tif (!this.teamTypes || this.teamTypes.length === 0) {\n\t\t\t\t\treturn '通用团队'\n\t\t\t\t}\n\t\t\t\tconst type = this.teamTypes.find(t => t.value === this.groupForm.team_type)\n\t\t\t\treturn type ? type.label : '通用团队'\n\t\t\t},\n\n\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.group-container {\n\t\tpadding: 20rpx;\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f5f5f5;\n\t}\n\t\n\t.header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 30rpx;\n\t\tpadding: 20rpx;\n\t\tbackground: #ffffff;\n\t\tborder-radius: 16rpx;\n\t}\n\t\n\t.page-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t}\n\t\n\t.page-subtitle {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tdisplay: block;\n\t\tmargin-top: 8rpx;\n\t}\n\t\n\t.header-actions {\n\t\tdisplay: flex;\n\t\tgap: 16rpx;\n\t}\n\n\t.browse-btn, .add-btn {\n\t\twidth: 80rpx;\n\t\theight: 80rpx;\n\t\tborder-radius: 40rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: none;\n\t}\n\n\t.browse-btn {\n\t\tbackground: #34c759;\n\t}\n\n\t.add-btn {\n\t\tbackground: #007aff;\n\t}\n\t\n\t.browse-icon, .add-icon {\n\t\tcolor: #ffffff;\n\t\tfont-size: 40rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.group-item {\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 24rpx;\n\t}\n\t\n\t.group-header {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tmargin-bottom: 16rpx;\n\t}\n\t\n\t.group-avatar {\n\t\twidth: 80rpx;\n\t\theight: 80rpx;\n\t\tborder-radius: 40rpx;\n\t\tbackground: #007aff;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tcolor: #ffffff;\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tmargin-right: 20rpx;\n\t}\n\t\n\t.group-info {\n\t\tflex: 1;\n\t}\n\t\n\t.group-name {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t\tmargin-bottom: 8rpx;\n\t\tline-height: 1.4;\n\t\tword-wrap: break-word;\n\t\tword-break: break-all;\n\t}\n\t\n\t.group-meta {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 16rpx;\n\t}\n\t\n\t.member-count {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t}\n\t\n\t.role-badge {\n\t\tfont-size: 20rpx;\n\t\tpadding: 4rpx 12rpx;\n\t\tborder-radius: 12rpx;\n\t\tcolor: #ffffff;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t.role-badge.admin {\n\t\tbackground: linear-gradient(135deg, #ff6b6b, #ffa500);\n\t\tfont-weight: bold;\n\t}\n\n\t.role-badge.member {\n\t\tbackground: #007aff;\n\t}\n\n\t.role-icon {\n\t\tmargin-right: 4rpx;\n\t\tfont-size: 18rpx;\n\t}\n\t\n\t.group-actions {\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t}\n\t\n\t.group-description {\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t\tline-height: 1.5;\n\t\tmargin-bottom: 16rpx;\n\t\tword-wrap: break-word;\n\t\tword-break: break-all;\n\t\t/* 限制最多显示2行 */\n\t\tdisplay: -webkit-box;\n\t\t-webkit-line-clamp: 2;\n\t\t-webkit-box-orient: vertical;\n\t\toverflow: hidden;\n\t}\n\t\n\t.group-footer {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding-top: 16rpx;\n\t\tborder-top: 2rpx solid #f0f0f0;\n\t}\n\t\n\t.join-date {\n\t\tfont-size: 24rpx;\n\t\tcolor: #999;\n\t}\n\t\n\t.btn.small {\n\t\tpadding: 12rpx 24rpx;\n\t\tfont-size: 24rpx;\n\t\theight: auto;\n\t\tline-height: 1.2;\n\t}\n\t\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 120rpx 40rpx;\n\t}\n\t\n\t.empty-icon {\n\t\tfont-size: 120rpx;\n\t\tdisplay: block;\n\t\tmargin-bottom: 30rpx;\n\t}\n\t\n\t.empty-title {\n\t\tfont-size: 36rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t\tmargin-bottom: 16rpx;\n\t}\n\t\n\t.empty-subtitle {\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t\tdisplay: block;\n\t\tmargin-bottom: 40rpx;\n\t}\n\t\n\t.loading-state {\n\t\ttext-align: center;\n\t\tpadding: 60rpx;\n\t\tcolor: #666;\n\t}\n\t\n\t.modal-overlay {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tz-index: 1000;\n\t}\n\t\n\t.modal-content {\n\t\twidth: 90%;\n\t\tmax-height: 80%;\n\t\tbackground: #ffffff;\n\t\tborder-radius: 16rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.modal-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 30rpx;\n\t\tborder-bottom: 2rpx solid #f0f0f0;\n\t}\n\t\n\t.modal-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.modal-close {\n\t\tfont-size: 40rpx;\n\t\tcolor: #999;\n\t}\n\t\n\t.modal-body {\n\t\tflex: 1;\n\t\tpadding: 30rpx;\n\t\toverflow-y: auto;\n\t}\n\t\n\t.form-item {\n\t\tmargin-bottom: 30rpx;\n\t}\n\t\n\t.label {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tmargin-bottom: 12rpx;\n\t}\n\n\t.required {\n\t\tcolor: #ff3b30;\n\t\tfont-weight: bold;\n\t}\n\n\t.picker {\n\t\twidth: 100%;\n\t}\n\n\t.picker-display {\n\t\twidth: 100%;\n\t\theight: 80rpx;\n\t\tpadding: 20rpx;\n\t\tborder: 2rpx solid #e0e0e0;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 28rpx;\n\t\tbox-sizing: border-box;\n\t\tline-height: 40rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tbackground-color: #fff;\n\t}\n\n\t.picker-arrow {\n\t\tcolor: #999;\n\t\tfont-size: 24rpx;\n\t}\n\n\t.form-hint {\n\t\tdisplay: block;\n\t\tfont-size: 24rpx;\n\t\tcolor: #999;\n\t\tmargin-top: 8rpx;\n\t\tline-height: 1.4;\n\t}\n\n\t.input {\n\t\twidth: 100%;\n\t\theight: 80rpx;\n\t\tpadding: 20rpx;\n\t\tborder: 2rpx solid #e0e0e0;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 28rpx;\n\t\tbox-sizing: border-box;\n\t\tline-height: 1.4;\n\t\ttext-align: left;\n\t}\n\n\t.input::placeholder {\n\t\tcolor: #999;\n\t\ttext-align: left;\n\t}\n\n\t.textarea {\n\t\twidth: 100%;\n\t\theight: 120rpx;\n\t\tpadding: 20rpx;\n\t\tborder: 2rpx solid #e0e0e0;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 28rpx;\n\t\tbox-sizing: border-box;\n\t\tresize: none;\n\t\tline-height: 1.4;\n\t}\n\n\t.textarea::placeholder {\n\t\tcolor: #999;\n\t}\n\t\n\t.detail-section {\n\t\tmargin-bottom: 30rpx;\n\t}\n\t\n\t.detail-label {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.detail-value {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t}\n\n\t.members-preview {\n\t\tmargin-top: 16rpx;\n\t}\n\n\t.member-list-preview {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 12rpx;\n\t\tmargin-bottom: 16rpx;\n\t\tmax-height: 80rpx; /* 限制为两行 */\n\t\toverflow: hidden;\n\t}\n\n\t.member-item {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tbackground-color: #f5f5f5;\n\t\tpadding: 6rpx 12rpx;\n\t\tborder-radius: 12rpx;\n\t}\n\n\t.member-item.leader {\n\t\tbackground-color: #fff3cd;\n\t\tcolor: #856404;\n\t\tfont-weight: 500;\n\t}\n\n\t.member-more {\n\t\tfont-size: 24rpx;\n\t\tcolor: #999;\n\t\tpadding: 6rpx 12rpx;\n\t}\n\n\t.view-all-members {\n\t\tfont-size: 26rpx;\n\t\tcolor: #007aff;\n\t\ttext-decoration: underline;\n\t}\n\n\t.action-buttons {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tgap: 20rpx;\n\t\tmargin-bottom: 20rpx;\n\t}\n\n\t.action-btn {\n\t\tflex: 1;\n\t\theight: 80rpx;\n\t\tbackground-color: #f8f9fa;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #495057;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.action-btn:active {\n\t\tbackground-color: #e9ecef;\n\t}\n\n\t.exit-btn {\n\t\twidth: 100%;\n\t\tmargin-top: 10rpx;\n\t}\n\t\n\t.modal-footer {\n\t\tdisplay: flex;\n\t\tgap: 20rpx;\n\t\tpadding: 30rpx;\n\t\tborder-top: 2rpx solid #f0f0f0;\n\t}\n\t\n\t.modal-footer .btn {\n\t\tflex: 1;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\ttext-align: center;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 28rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: none;\n\t}\n\n\t.role-tip {\n\t\tflex: 1;\n\t\ttext-align: center;\n\t\tcolor: #999;\n\t\tfont-size: 24rpx;\n\t\tline-height: 80rpx;\n\t}\n\t\n\t.btn-danger {\n\t\tbackground: #ff3b30;\n\t\tcolor: #ffffff;\n\t}\n</style>\n","import MiniProgramPage from 'C:/D/re/kirojianlu/jianlu-uniapp/pages/team/team.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","formatDate","groupApi","showError","showSuccess","showConfirm"],"mappings":"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"}