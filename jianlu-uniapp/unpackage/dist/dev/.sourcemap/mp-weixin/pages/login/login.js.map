{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../D/HBuilderX.4.56.2025031210/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\n\t<view class=\"login-container\">\n\t\t<!-- È°∂ÈÉ®Áä∂ÊÄÅÊ†èÂç†‰Ωç -->\n\t\t<view class=\"status-bar\" :style=\"{height: statusBarHeight + 'px'}\"></view>\n\t\t\n\t\t<!-- ÁôªÂΩïÂÜÖÂÆπ -->\n\t\t<view class=\"login-content\">\n\t\t\t<!-- LogoÂíåÊ†áÈ¢ò -->\n\t\t\t<view class=\"logo-section\">\n\t\t\t\t<view class=\"logo\">üìñ</view>\n\t\t\t\t<text class=\"title\">ÁÆÄÂ∫êÊó•ËÆ∞</text>\n\t\t\t\t<text class=\"subtitle\">{{ isLogin ? 'ËÆ∞ÂΩïÁîüÊ¥ªÔºåÂàÜ‰∫´ÁæéÂ•Ω' : 'ÂºÄÂßãÊÇ®ÁöÑÊó•ËÆ∞‰πãÊóÖ' }}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- ÁôªÂΩïË°®Âçï -->\n\t\t\t<view class=\"form-section\" v-if=\"isLogin\">\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•Áî®Êà∑Âêç\"\n\t\t\t\t\t\tv-model=\"loginForm.username\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\t:type=\"showPassword ? 'text' : 'password'\"\n\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•ÂØÜÁ†Å\"\n\t\t\t\t\t\tv-model=\"loginForm.password\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t\t<view class=\"password-toggle\" @tap=\"togglePassword\">\n\t\t\t\t\t\t{{ showPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<button \n\t\t\t\t\tclass=\"btn btn-primary login-btn\" \n\t\t\t\t\t@tap=\"handleLogin\"\n\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t>\n\t\t\t\t\t{{ loading ? 'ÁôªÂΩï‰∏≠...' : 'ÁôªÂΩï' }}\n\t\t\t\t</button>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- Ê≥®ÂÜåË°®Âçï -->\n\t\t\t<view class=\"form-section\" v-else>\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•Áî®Êà∑Âêç\"\n\t\t\t\t\t\tv-model=\"registerForm.username\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•ÈÇÆÁÆ±\"\n\t\t\t\t\t\tv-model=\"registerForm.email\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•ÊòµÁß∞ÔºàÂèØÈÄâÔºâ\"\n\t\t\t\t\t\tv-model=\"registerForm.nickname\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\ttype=\"password\" \n\t\t\t\t\t\tplaceholder=\"ËØ∑ËæìÂÖ•ÂØÜÁ†Å\"\n\t\t\t\t\t\tv-model=\"registerForm.password\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\ttype=\"password\" \n\t\t\t\t\t\tplaceholder=\"ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å\"\n\t\t\t\t\t\tv-model=\"registerForm.confirmPassword\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t/>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<button \n\t\t\t\t\tclass=\"btn btn-primary login-btn\" \n\t\t\t\t\t@tap=\"handleRegister\"\n\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t>\n\t\t\t\t\t{{ loading ? 'Ê≥®ÂÜå‰∏≠...' : 'Ê≥®ÂÜå' }}\n\t\t\t\t</button>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- ÂàáÊç¢ÁôªÂΩï/Ê≥®ÂÜå -->\n\t\t\t<view class=\"switch-section\">\n\t\t\t\t<text class=\"switch-text\" @tap=\"toggleMode\">\n\t\t\t\t\t{{ isLogin ? 'Ê≤°ÊúâË¥¶Êà∑ÔºüÁ´ãÂç≥Ê≥®ÂÜå' : 'Â∑≤ÊúâË¥¶Êà∑ÔºüÁ´ãÂç≥ÁôªÂΩï' }}\n\t\t\t\t</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- ÊµãËØïË¥¶Êà∑ÊèêÁ§∫ -->\n\t\t\t<view class=\"test-account\">\n\t\t\t\t<text class=\"test-title\">ÊµãËØïË¥¶Êà∑Ôºö</text>\n\t\t\t\t<text class=\"test-info\">ÁÆ°ÁêÜÂëò: admin / admin123</text>\n\t\t\t\t<text class=\"test-info\">ÊµãËØïÁî®Êà∑: testuser / testpass123</text>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\n\timport { ref, reactive, onMounted } from 'vue'\n\timport { authApi } from '../../api/index.js'\n\timport { showSuccess, showError } from '../../utils/index.js'\n\n\t// ÂìçÂ∫îÂºèÊï∞ÊçÆ\n\tconst statusBarHeight = ref(0)\n\tconst isLogin = ref(true)\n\tconst showPassword = ref(false)\n\tconst loading = ref(false)\n\n\tconst loginForm = reactive({\n\t\tusername: '',\n\t\tpassword: ''\n\t})\n\n\tconst registerForm = reactive({\n\t\tusername: '',\n\t\temail: '',\n\t\tnickname: '',\n\t\tpassword: '',\n\t\tconfirmPassword: ''\n\t})\n\n\t// È°µÈù¢Âä†ËΩΩÊó∂ÊâßË°å\n\tonMounted(() => {\n\t\t// Ëé∑ÂèñÁä∂ÊÄÅÊ†èÈ´òÂ∫¶\n\t\tconst systemInfo = uni.getSystemInfoSync()\n\t\tstatusBarHeight.value = systemInfo.statusBarHeight\n\t})\n\t// ÊñπÊ≥ïÂÆö‰πâ\n\tconst toggleMode = () => {\n\t\tisLogin.value = !isLogin.value\n\t\tclearForms()\n\t}\n\n\tconst togglePassword = () => {\n\t\tshowPassword.value = !showPassword.value\n\t}\n\n\tconst clearForms = () => {\n\t\tObject.assign(loginForm, {\n\t\t\tusername: '',\n\t\t\tpassword: ''\n\t\t})\n\t\tObject.assign(registerForm, {\n\t\t\tusername: '',\n\t\t\temail: '',\n\t\t\tnickname: '',\n\t\t\tpassword: '',\n\t\t\tconfirmPassword: ''\n\t\t})\n\t}\n\t\t\t\n\tconst handleLogin = async () => {\n\t\tif (!loginForm.username || !loginForm.password) {\n\t\t\tshowError('ËØ∑Â°´ÂÜôÁî®Êà∑ÂêçÂíåÂØÜÁ†Å')\n\t\t\treturn\n\t\t}\n\n\t\tloading.value = true\n\t\tconsole.log('ÂºÄÂßãÁôªÂΩïÔºåÁî®Êà∑Âêç:', loginForm.username)\n\n\t\ttry {\n\t\t\tconsole.log('ÂèëÈÄÅÁôªÂΩïËØ∑Ê±ÇÂà∞:', 'http://localhost:3458/api/auth/login')\n\t\t\tconsole.log('ÁôªÂΩïÊï∞ÊçÆ:', loginForm)\n\n\t\t\tconst response = await authApi.login(loginForm)\n\t\t\tconsole.log('ÁôªÂΩïÂìçÂ∫î:', response)\n\n\t\t\tif (response.success) {\n\t\t\t\t// ‰øùÂ≠òtokenÂíåÁî®Êà∑‰ø°ÊÅØ\n\t\t\t\tuni.setStorageSync('token', response.data.token)\n\t\t\t\tuni.setStorageSync('userInfo', response.data.user)\n\n\t\t\t\tconsole.log('ÁôªÂΩïÊàêÂäüÔºåtokenÂ∑≤‰øùÂ≠ò')\n\t\t\t\tshowSuccess('ÁôªÂΩïÊàêÂäü')\n\n\t\t\t\t// Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\turl: '/pages/home/home'\n\t\t\t\t\t})\n\t\t\t\t}, 1000)\n\t\t\t} else {\n\t\t\t\tconsole.error('ÁôªÂΩïÂ§±Ë¥•ÔºåÂìçÂ∫î:', response)\n\t\t\t\tshowError(response.message || 'ÁôªÂΩïÂ§±Ë¥•')\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('ÁôªÂΩïÂºÇÂ∏∏:', error)\n\t\t\tshowError(`ÁôªÂΩïÂ§±Ë¥•: ${error.message || 'ÁΩëÁªúÈîôËØØ'}`)\n\t\t} finally {\n\t\t\tloading.value = false\n\t\t}\n\t}\n\t\t\t\n\tconst handleRegister = async () => {\n\t\tconst { username, email, password, confirmPassword, nickname } = registerForm\n\n\t\tif (!username || !email || !password) {\n\t\t\tshowError('ËØ∑Â°´ÂÜôÂøÖË¶Å‰ø°ÊÅØ')\n\t\t\treturn\n\t\t}\n\n\t\tif (password !== confirmPassword) {\n\t\t\tshowError('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥')\n\t\t\treturn\n\t\t}\n\n\t\tloading.value = true\n\t\ttry {\n\t\t\tconst response = await authApi.register({\n\t\t\t\tusername,\n\t\t\t\temail,\n\t\t\t\tpassword,\n\t\t\t\tnickname\n\t\t\t})\n\n\t\t\tif (response.success) {\n\t\t\t\t// ‰øùÂ≠òtokenÂíåÁî®Êà∑‰ø°ÊÅØ\n\t\t\t\tuni.setStorageSync('token', response.data.token)\n\t\t\t\tuni.setStorageSync('userInfo', response.data.user)\n\n\t\t\t\tshowSuccess('Ê≥®ÂÜåÊàêÂäü')\n\n\t\t\t\t// Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\turl: '/pages/home/home'\n\t\t\t\t\t})\n\t\t\t\t}, 1000)\n\t\t\t} else {\n\t\t\t\tshowError(response.message || 'Ê≥®ÂÜåÂ§±Ë¥•')\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tshowError(error.message || 'Ê≥®ÂÜåÂ§±Ë¥•')\n\t\t} finally {\n\t\t\tloading.value = false\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.login-container {\n\t\tmin-height: 100vh;\n\t\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.status-bar {\n\t\tbackground: transparent;\n\t}\n\t\n\t.login-content {\n\t\tflex: 1;\n\t\tpadding: 60rpx 40rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t}\n\t\n\t.logo-section {\n\t\ttext-align: center;\n\t\tmargin-bottom: 80rpx;\n\t}\n\t\n\t.logo {\n\t\tfont-size: 120rpx;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.title {\n\t\tdisplay: block;\n\t\tfont-size: 48rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #ffffff;\n\t\tmargin-bottom: 16rpx;\n\t}\n\t\n\t.subtitle {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: rgba(255, 255, 255, 0.8);\n\t}\n\t\n\t.form-section {\n\t\tbackground: rgba(255, 255, 255, 0.95);\n\t\tborder-radius: 20rpx;\n\t\tpadding: 40rpx;\n\t\tmargin-bottom: 40rpx;\n\t}\n\t\n\t.form-item {\n\t\tposition: relative;\n\t\tmargin-bottom: 30rpx;\n\t}\n\t\n\t.form-item:last-child {\n\t\tmargin-bottom: 0;\n\t}\n\t\n\t.input {\n\t\twidth: 100%;\n\t\theight: 88rpx;\n\t\tpadding: 0 20rpx;\n\t\tborder: 2rpx solid #e0e0e0;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.input:focus {\n\t\tborder-color: #667eea;\n\t}\n\t\n\t.password-toggle {\n\t\tposition: absolute;\n\t\tright: 20rpx;\n\t\ttop: 50%;\n\t\ttransform: translateY(-50%);\n\t\tfont-size: 32rpx;\n\t\tcolor: #999;\n\t}\n\t\n\t.login-btn {\n\t\twidth: 100%;\n\t\theight: 88rpx;\n\t\tmargin-top: 40rpx;\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.switch-section {\n\t\ttext-align: center;\n\t}\n\t\n\t.switch-text {\n\t\tcolor: rgba(255, 255, 255, 0.9);\n\t\tfont-size: 28rpx;\n\t\ttext-decoration: underline;\n\t}\n\t\n\t.test-account {\n\t\tmargin-top: 60rpx;\n\t\tpadding: 30rpx;\n\t\tbackground: rgba(255, 255, 255, 0.1);\n\t\tborder-radius: 16rpx;\n\t\ttext-align: center;\n\t}\n\t\n\t.test-title {\n\t\tdisplay: block;\n\t\tcolor: #ffffff;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 16rpx;\n\t}\n\t\n\t.test-info {\n\t\tdisplay: block;\n\t\tcolor: rgba(255, 255, 255, 0.8);\n\t\tfont-size: 24rpx;\n\t\tmargin-bottom: 8rpx;\n\t}\n</style>\n","import MiniProgramPage from 'C:/vscode/kirojianlu/jianlu-uniapp/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","onMounted","uni","showError","authApi","showSuccess"],"mappings":"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"}