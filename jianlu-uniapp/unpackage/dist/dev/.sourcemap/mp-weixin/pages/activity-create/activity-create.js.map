{"version":3,"file":"activity-create.js","sources":["pages/activity-create/activity-create.vue","../../../D/HBuilderX.4.56.2025031210/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWN0aXZpdHktY3JlYXRlL2FjdGl2aXR5LWNyZWF0ZS52dWU"],"sourcesContent":["<template>\n\t<view class=\"create-activity\">\n\t\t<form @submit=\"submitForm\">\n\t\t\t<!-- åŸºæœ¬ä¿¡æ¯ -->\n\t\t\t<view class=\"form-section\">\n\t\t\t\t<text class=\"section-title\">åŸºæœ¬ä¿¡æ¯</text>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">æ´»åŠ¨æ ‡é¢˜ *</text>\n\t\t\t\t\t<input class=\"form-input\" v-model=\"form.title\" placeholder=\"è¾“å…¥æ´»åŠ¨åç§°...\" maxlength=\"100\" />\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">æ´»åŠ¨æè¿°</text>\n\t\t\t\t\t<textarea class=\"form-textarea\" v-model=\"form.description\" placeholder=\"è¯·æè¿°æ´»åŠ¨å†…å®¹ã€ç›®çš„ç­‰\" maxlength=\"500\"></textarea>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">æ´»åŠ¨ç±»å‹ *</text>\n\t\t\t\t\t<view class=\"type-selector\">\n\t\t\t\t\t\t<view class=\"type-item\" \n\t\t\t\t\t\t\tv-for=\"(typeInfo, type) in activityTypes\" \n\t\t\t\t\t\t\t:key=\"type\"\n\t\t\t\t\t\t\t:class=\"{ active: form.activity_type === type }\"\n\t\t\t\t\t\t\t@tap=\"selectType(type)\">\n\t\t\t\t\t\t\t<text class=\"type-icon\">{{ typeInfo.icon }}</text>\n\t\t\t\t\t\t\t<text class=\"type-name\">{{ typeInfo.name }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">æ´»åŠ¨å¯è§æ€§ *</text>\n\t\t\t\t\t<view class=\"visibility-selector\">\n\t\t\t\t\t\t<view class=\"visibility-item\" \n\t\t\t\t\t\t\t:class=\"{ active: form.visibility === 'public' }\"\n\t\t\t\t\t\t\t@tap=\"selectVisibility('public')\">\n\t\t\t\t\t\t\t<text class=\"visibility-icon\">ğŸŒ</text>\n\t\t\t\t\t\t\t<view class=\"visibility-info\">\n\t\t\t\t\t\t\t\t<text class=\"visibility-name\">å…¬å¼€æ´»åŠ¨</text>\n\t\t\t\t\t\t\t\t<text class=\"visibility-desc\">æ‰€æœ‰ç”¨æˆ·å¯è§å’ŒæŠ¥å</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"visibility-item\" \n\t\t\t\t\t\t\t:class=\"{ active: form.visibility === 'team' }\"\n\t\t\t\t\t\t\t@tap=\"selectVisibility('team')\">\n\t\t\t\t\t\t\t<text class=\"visibility-icon\">ğŸ‘¥</text>\n\t\t\t\t\t\t\t<view class=\"visibility-info\">\n\t\t\t\t\t\t\t\t<text class=\"visibility-name\">å›¢é˜Ÿæ´»åŠ¨</text>\n\t\t\t\t\t\t\t\t<text class=\"visibility-desc\">ä»…å›¢é˜Ÿæˆå‘˜å¯è§å’ŒæŠ¥å</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\" v-if=\"form.visibility === 'team'\">\n\t\t\t\t\t<text class=\"form-label\">é€‰æ‹©å›¢é˜Ÿ *</text>\n\t\t\t\t\t<view class=\"team-selector\" @tap=\"showTeamPicker\">\n\t\t\t\t\t\t<text class=\"selector-text\" :class=\"{ placeholder: !selectedTeam }\">\n\t\t\t\t\t\t\t{{ selectedTeam ? selectedTeam.name : 'è¯·é€‰æ‹©å›¢é˜Ÿ' }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t\t<text class=\"selector-arrow\">></text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<!-- æ—¶é—´åœ°ç‚¹ -->\n\t\t\t<view class=\"form-section\">\n\t\t\t\t<text class=\"section-title\">æ—¶é—´åœ°ç‚¹</text>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">å¼€å§‹æ—¶é—´ *</text>\n\t\t\t\t\t<picker mode=\"date\" :value=\"startDate\" @change=\"onStartDateChange\">\n\t\t\t\t\t\t<view class=\"datetime-picker\">\n\t\t\t\t\t\t\t<text class=\"datetime-text\" :class=\"{ placeholder: !startDate }\">\n\t\t\t\t\t\t\t\t{{ startDate ? startDate : 'è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸ' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\" v-if=\"startDate\">\n\t\t\t\t\t<text class=\"form-label\">å¼€å§‹æ—¶é—´</text>\n\t\t\t\t\t<picker mode=\"time\" :value=\"startTime\" @change=\"onStartTimeChange\">\n\t\t\t\t\t\t<view class=\"datetime-picker\">\n\t\t\t\t\t\t\t<text class=\"datetime-text\" :class=\"{ placeholder: !startTime }\">\n\t\t\t\t\t\t\t\t{{ startTime ? startTime : 'è¯·é€‰æ‹©å¼€å§‹æ—¶é—´' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">ç»“æŸæ—¶é—´ *</text>\n\t\t\t\t\t<picker mode=\"date\" :value=\"endDate\" @change=\"onEndDateChange\">\n\t\t\t\t\t\t<view class=\"datetime-picker\">\n\t\t\t\t\t\t\t<text class=\"datetime-text\" :class=\"{ placeholder: !endDate }\">\n\t\t\t\t\t\t\t\t{{ endDate ? endDate : 'è¯·é€‰æ‹©ç»“æŸæ—¥æœŸ' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\" v-if=\"endDate\">\n\t\t\t\t\t<text class=\"form-label\">ç»“æŸæ—¶é—´</text>\n\t\t\t\t\t<picker mode=\"time\" :value=\"endTime\" @change=\"onEndTimeChange\">\n\t\t\t\t\t\t<view class=\"datetime-picker\">\n\t\t\t\t\t\t\t<text class=\"datetime-text\" :class=\"{ placeholder: !endTime }\">\n\t\t\t\t\t\t\t\t{{ endTime ? endTime : 'è¯·é€‰æ‹©ç»“æŸæ—¶é—´' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">æ´»åŠ¨åœ°ç‚¹</text>\n\t\t\t\t\t<input class=\"form-input\" v-model=\"form.location\" placeholder=\"è¯·è¾“å…¥æ´»åŠ¨åœ°ç‚¹\" />\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<!-- æŠ¥åè®¾ç½® -->\n\t\t\t<view class=\"form-section\">\n\t\t\t\t<text class=\"section-title\">æŠ¥åè®¾ç½®</text>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">äººæ•°é™åˆ¶</text>\n\t\t\t\t\t<view class=\"number-input\">\n\t\t\t\t\t\t<input class=\"form-input\" v-model.number=\"form.max_participants\" placeholder=\"0è¡¨ç¤ºæ— é™åˆ¶\" type=\"number\" />\n\t\t\t\t\t\t<text class=\"input-unit\">äºº</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<text class=\"form-label\">æŠ¥åæˆªæ­¢æ—¥æœŸ</text>\n\t\t\t\t\t<picker mode=\"date\" :value=\"deadlineDate\" @change=\"onDeadlineDateChange\">\n\t\t\t\t\t\t<view class=\"datetime-picker\">\n\t\t\t\t\t\t\t<text class=\"datetime-text\" :class=\"{ placeholder: !deadlineDate }\">\n\t\t\t\t\t\t\t\t{{ deadlineDate ? deadlineDate : 'è¯·é€‰æ‹©æˆªæ­¢æ—¥æœŸï¼ˆå¯é€‰ï¼‰' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\" v-if=\"deadlineDate\">\n\t\t\t\t\t<text class=\"form-label\">æŠ¥åæˆªæ­¢æ—¶é—´</text>\n\t\t\t\t\t<picker mode=\"time\" :value=\"deadlineTime\" @change=\"onDeadlineTimeChange\">\n\t\t\t\t\t\t<view class=\"datetime-picker\">\n\t\t\t\t\t\t\t<text class=\"datetime-text\" :class=\"{ placeholder: !deadlineTime }\">\n\t\t\t\t\t\t\t\t{{ deadlineTime ? deadlineTime : 'è¯·é€‰æ‹©æˆªæ­¢æ—¶é—´' }}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t<text class=\"picker-arrow\">></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</picker>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<view class=\"switch-item\">\n\t\t\t\t\t\t<text class=\"switch-label\">éœ€è¦å®¡æ ¸</text>\n\t\t\t\t\t\t<switch :checked=\"form.require_approval\" @change=\"toggleApproval\" />\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"switch-desc\">å¼€å¯åï¼Œç”¨æˆ·æŠ¥åéœ€è¦æ‚¨çš„å®¡æ ¸é€šè¿‡</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<!-- è´¹ç”¨è®¾ç½® -->\n\t\t\t<view class=\"form-section\">\n\t\t\t\t<text class=\"section-title\">è´¹ç”¨è®¾ç½®</text>\n\n\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t<view class=\"switch-item\">\n\t\t\t\t\t\t<text class=\"switch-label\">å…è´¹æ´»åŠ¨</text>\n\t\t\t\t\t\t<switch :checked=\"form.is_free\" @change=\"toggleFree\" />\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<view class=\"form-item\" v-if=\"!form.is_free\">\n\t\t\t\t\t<text class=\"form-label\">åŸºç¡€è´¹ç”¨</text>\n\t\t\t\t\t<view class=\"number-input\">\n\t\t\t\t\t\t<text class=\"input-prefix\">Â¥</text>\n\t\t\t\t\t\t<input class=\"form-input\" v-model.number=\"form.base_fee\" placeholder=\"0.00\" type=\"digit\" />\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<!-- æäº¤æŒ‰é’® -->\n\t\t\t<view class=\"submit-section\">\n\t\t\t\t<button class=\"btn btn-outline\" @tap=\"saveDraft\">ä¿å­˜è‰ç¨¿</button>\n\t\t\t\t<button class=\"btn btn-primary\" @tap=\"publishActivity\">å‘å¸ƒæ´»åŠ¨</button>\n\t\t\t</view>\n\t\t</form>\n\n\t\t<!-- å›¢é˜Ÿé€‰æ‹©å¼¹çª— -->\n\t\t<view class=\"modal-overlay\" v-if=\"showTeamModal\" @tap=\"hideTeamModal\">\n\t\t\t<view class=\"modal-content\" @tap.stop>\n\t\t\t\t<view class=\"modal-header\">\n\t\t\t\t\t<text class=\"modal-title\">é€‰æ‹©å›¢é˜Ÿ</text>\n\t\t\t\t\t<text class=\"modal-close\" @tap=\"hideTeamModal\">Ã—</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"modal-body\">\n\t\t\t\t\t<view class=\"team-list\">\n\t\t\t\t\t\t<view class=\"team-item\" \n\t\t\t\t\t\t\tv-for=\"team in myTeams\" \n\t\t\t\t\t\t\t:key=\"team.id\"\n\t\t\t\t\t\t\t@tap=\"selectTeam(team)\">\n\t\t\t\t\t\t\t<text class=\"team-name\">{{ team.name }}</text>\n\t\t\t\t\t\t\t<text class=\"team-role\">{{ team.role === 'admin' ? 'è´Ÿè´£äºº' : 'æˆå‘˜' }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport { activityApi, activityTypes } from '../../api/activity.js'\n\timport { groupApi } from '../../api/index.js'\n\timport { showError, showSuccess, formatDate } from '../../utils/index.js'\n\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tform: {\n\t\t\t\t\ttitle: '',\n\t\t\t\t\tdescription: '',\n\t\t\t\t\tactivity_type: '',\n\t\t\t\t\tvisibility: 'public',\n\t\t\t\t\tteam_id: null,\n\t\t\t\t\tstart_time: '',\n\t\t\t\t\tend_time: '',\n\t\t\t\t\tlocation: '',\n\t\t\t\t\tmax_participants: 0,\n\t\t\t\t\tregistration_deadline: '',\n\t\t\t\t\trequire_approval: false,\n\t\t\t\t\tis_free: true,\n\t\t\t\t\tbase_fee: 0\n\t\t\t\t},\n\t\t\t\tactivityTypes,\n\t\t\t\tmyTeams: [],\n\t\t\t\tselectedTeam: null,\n\t\t\t\tshowTeamModal: false,\n\t\t\t\tsubmitting: false,\n\n\t\t\t\t// æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ç›¸å…³æ•°æ®\n\t\t\t\tstartDate: '',\n\t\t\t\tstartTime: '',\n\t\t\t\tendDate: '',\n\t\t\t\tendTime: '',\n\t\t\t\tdeadlineDate: '',\n\t\t\t\tdeadlineTime: ''\n\t\t\t}\n\t\t},\n\n\t\tonLoad() {\n\t\t\tthis.loadMyTeams()\n\t\t\tthis.initDefaultDateTime()\n\t\t},\n\n\t\tmethods: {\n\t\t\t// åŠ è½½æˆ‘çš„å›¢é˜Ÿåˆ—è¡¨\n\t\t\tasync loadMyTeams() {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await groupApi.getMyTeams()\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tthis.myTeams = response.data\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('åŠ è½½å›¢é˜Ÿåˆ—è¡¨å¤±è´¥:', error)\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// é€‰æ‹©æ´»åŠ¨ç±»å‹\n\t\t\tselectType(type) {\n\t\t\t\tthis.form.activity_type = type\n\t\t\t},\n\n\t\t\t// é€‰æ‹©å¯è§æ€§\n\t\t\tselectVisibility(visibility) {\n\t\t\t\tthis.form.visibility = visibility\n\t\t\t\tif (visibility === 'public') {\n\t\t\t\t\tthis.form.team_id = null\n\t\t\t\t\tthis.selectedTeam = null\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// æ˜¾ç¤ºå›¢é˜Ÿé€‰æ‹©å™¨\n\t\t\tshowTeamPicker() {\n\t\t\t\tif (this.myTeams.length === 0) {\n\t\t\t\t\tshowError('æ‚¨è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•å›¢é˜Ÿ')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.showTeamModal = true\n\t\t\t},\n\n\t\t\t// éšè—å›¢é˜Ÿé€‰æ‹©å™¨\n\t\t\thideTeamModal() {\n\t\t\t\tthis.showTeamModal = false\n\t\t\t},\n\n\t\t\t// é€‰æ‹©å›¢é˜Ÿ\n\t\t\tselectTeam(team) {\n\t\t\t\tthis.selectedTeam = team\n\t\t\t\tthis.form.team_id = team.id\n\t\t\t\tthis.hideTeamModal()\n\t\t\t},\n\n\t\t\t// åˆå§‹åŒ–é»˜è®¤æ—¥æœŸæ—¶é—´\n\t\t\tinitDefaultDateTime() {\n\t\t\t\tconst now = new Date()\n\t\t\t\tconst today = this.formatDate(now)\n\t\t\t\tconst currentTime = this.formatTime(now)\n\n\t\t\t\t// è®¾ç½®é»˜è®¤å¼€å§‹æ—¶é—´ä¸ºå½“å‰æ—¶é—´\n\t\t\t\tthis.startDate = today\n\t\t\t\tthis.startTime = currentTime\n\n\t\t\t\t// è®¾ç½®é»˜è®¤ç»“æŸæ—¶é—´ä¸º2å°æ—¶å\n\t\t\t\tconst endDateTime = new Date(now.getTime() + 2 * 60 * 60 * 1000)\n\t\t\t\tthis.endDate = this.formatDate(endDateTime)\n\t\t\t\tthis.endTime = this.formatTime(endDateTime)\n\n\t\t\t\t// æ›´æ–°è¡¨å•æ•°æ®\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// å¼€å§‹æ—¥æœŸé€‰æ‹©å˜åŒ–\n\t\t\tonStartDateChange(e) {\n\t\t\t\tthis.startDate = e.detail.value\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// å¼€å§‹æ—¶é—´é€‰æ‹©å˜åŒ–\n\t\t\tonStartTimeChange(e) {\n\t\t\t\tthis.startTime = e.detail.value\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// ç»“æŸæ—¥æœŸé€‰æ‹©å˜åŒ–\n\t\t\tonEndDateChange(e) {\n\t\t\t\tthis.endDate = e.detail.value\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// ç»“æŸæ—¶é—´é€‰æ‹©å˜åŒ–\n\t\t\tonEndTimeChange(e) {\n\t\t\t\tthis.endTime = e.detail.value\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// æˆªæ­¢æ—¥æœŸé€‰æ‹©å˜åŒ–\n\t\t\tonDeadlineDateChange(e) {\n\t\t\t\tthis.deadlineDate = e.detail.value\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// æˆªæ­¢æ—¶é—´é€‰æ‹©å˜åŒ–\n\t\t\tonDeadlineTimeChange(e) {\n\t\t\t\tthis.deadlineTime = e.detail.value\n\t\t\t\tthis.updateFormDateTime()\n\t\t\t},\n\n\t\t\t// æ›´æ–°è¡¨å•ä¸­çš„æ—¥æœŸæ—¶é—´æ•°æ®\n\t\t\tupdateFormDateTime() {\n\t\t\t\t// æ›´æ–°å¼€å§‹æ—¶é—´\n\t\t\t\tif (this.startDate && this.startTime) {\n\t\t\t\t\tthis.form.start_time = `${this.startDate} ${this.startTime}:00`\n\t\t\t\t}\n\n\t\t\t\t// æ›´æ–°ç»“æŸæ—¶é—´\n\t\t\t\tif (this.endDate && this.endTime) {\n\t\t\t\t\tthis.form.end_time = `${this.endDate} ${this.endTime}:00`\n\t\t\t\t}\n\n\t\t\t\t// æ›´æ–°æˆªæ­¢æ—¶é—´\n\t\t\t\tif (this.deadlineDate && this.deadlineTime) {\n\t\t\t\t\tthis.form.registration_deadline = `${this.deadlineDate} ${this.deadlineTime}:00`\n\t\t\t\t} else if (this.deadlineDate) {\n\t\t\t\t\tthis.form.registration_deadline = `${this.deadlineDate} 23:59:00`\n\t\t\t\t} else {\n\t\t\t\t\tthis.form.registration_deadline = ''\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// æ ¼å¼åŒ–æ—¥æœŸ\n\t\t\tformatDate(date) {\n\t\t\t\tconst year = date.getFullYear()\n\t\t\t\tconst month = String(date.getMonth() + 1).padStart(2, '0')\n\t\t\t\tconst day = String(date.getDate()).padStart(2, '0')\n\t\t\t\treturn `${year}-${month}-${day}`\n\t\t\t},\n\n\t\t\t// æ ¼å¼åŒ–æ—¶é—´\n\t\t\tformatTime(date) {\n\t\t\t\tconst hour = String(date.getHours()).padStart(2, '0')\n\t\t\t\tconst minute = String(date.getMinutes()).padStart(2, '0')\n\t\t\t\treturn `${hour}:${minute}`\n\t\t\t},\n\n\t\t\t// åˆ‡æ¢å®¡æ ¸å¼€å…³\n\t\t\ttoggleApproval(e) {\n\t\t\t\tthis.form.require_approval = e.detail.value\n\t\t\t},\n\n\t\t\t// åˆ‡æ¢å…è´¹å¼€å…³\n\t\t\ttoggleFree(e) {\n\t\t\t\tthis.form.is_free = e.detail.value\n\t\t\t\tif (e.detail.value) {\n\t\t\t\t\tthis.form.base_fee = 0\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// éªŒè¯è¡¨å•\n\t\t\tvalidateForm() {\n\t\t\t\tif (!this.form.title.trim()) {\n\t\t\t\t\tshowError('è¯·è¾“å…¥æ´»åŠ¨æ ‡é¢˜')\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!this.form.activity_type) {\n\t\t\t\t\tshowError('è¯·é€‰æ‹©æ´»åŠ¨ç±»å‹')\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!this.form.start_time) {\n\t\t\t\t\tshowError('è¯·é€‰æ‹©å¼€å§‹æ—¶é—´')\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (!this.form.end_time) {\n\t\t\t\t\tshowError('è¯·é€‰æ‹©ç»“æŸæ—¶é—´')\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tif (this.form.visibility === 'team' && !this.form.team_id) {\n\t\t\t\t\tshowError('è¯·é€‰æ‹©å›¢é˜Ÿ')\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t},\n\n\t\t\t// ä¿å­˜è‰ç¨¿\n\t\t\tasync saveDraft() {\n\t\t\t\tif (!this.validateForm()) return\n\n\t\t\t\tthis.submitting = true\n\t\t\t\ttry {\n\t\t\t\t\tconst formData = { ...this.form, status: 'draft' }\n\t\t\t\t\tconst response = await activityApi.create(formData)\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tshowSuccess('è‰ç¨¿ä¿å­˜æˆåŠŸ')\n\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('ä¿å­˜è‰ç¨¿å¤±è´¥:', error)\n\t\t\t\t\tshowError('ä¿å­˜è‰ç¨¿å¤±è´¥')\n\t\t\t\t} finally {\n\t\t\t\t\tthis.submitting = false\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// å‘å¸ƒæ´»åŠ¨\n\t\t\tasync publishActivity() {\n\t\t\t\tif (!this.validateForm()) return\n\n\t\t\t\tthis.submitting = true\n\t\t\t\ttry {\n\t\t\t\t\tconst formData = { ...this.form, status: 'registration' }\n\t\t\t\t\tconst response = await activityApi.create(formData)\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\tshowSuccess('æ´»åŠ¨å‘å¸ƒæˆåŠŸ')\n\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('å‘å¸ƒæ´»åŠ¨å¤±è´¥:', error)\n\t\t\t\t\tshowError('å‘å¸ƒæ´»åŠ¨å¤±è´¥')\n\t\t\t\t} finally {\n\t\t\t\t\tthis.submitting = false\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´\n\t\t\tformatDateTime(datetime) {\n\t\t\t\treturn formatDate(datetime, 'YYYYå¹´MMæœˆDDæ—¥ HH:mm')\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.create-activity {\n\t\tbackground-color: #f5f5f5;\n\t\tmin-height: 100vh;\n\t\tpadding-bottom: 40rpx;\n\t}\n\n\t.form-section {\n\t\tbackground-color: white;\n\t\tmargin: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\tpadding: 40rpx;\n\t\tmargin-bottom: 20rpx;\n\t}\n\n\t.section-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t\tmargin-bottom: 40rpx;\n\t}\n\n\t.form-item {\n\t\tmargin-bottom: 40rpx;\n\t}\n\n\t.form-item:last-child {\n\t\tmargin-bottom: 0;\n\t}\n\n\t.form-label {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t\tmargin-bottom: 16rpx;\n\t}\n\n\t.form-input,\n\t.form-textarea {\n\t\twidth: 100%;\n\t\tpadding: 20rpx;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tbox-sizing: border-box;\n\t\tline-height: 1.4;\n\t}\n\n\t.form-input {\n\t\theight: 80rpx;\n\t}\n\n\t.form-input::placeholder,\n\t.form-textarea::placeholder {\n\t\tcolor: #999;\n\t\tfont-size: 28rpx;\n\t}\n\n\t.form-textarea {\n\t\theight: 120rpx;\n\t\tresize: none;\n\t}\n\n\t.type-selector {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 20rpx;\n\t}\n\n\t.type-item {\n\t\tflex: 1;\n\t\tmin-width: 200rpx;\n\t\tpadding: 30rpx 20rpx;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\ttext-align: center;\n\t\ttransition: all 0.3s;\n\t}\n\n\t.type-item.active {\n\t\tborder-color: #007aff;\n\t\tbackground-color: #f0f8ff;\n\t}\n\n\t.type-icon {\n\t\tfont-size: 40rpx;\n\t\tdisplay: block;\n\t\tmargin-bottom: 12rpx;\n\t}\n\n\t.type-name {\n\t\tfont-size: 26rpx;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t}\n\n\t.visibility-selector {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 20rpx;\n\t}\n\n\t.visibility-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 30rpx;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\ttransition: all 0.3s;\n\t}\n\n\t.visibility-item.active {\n\t\tborder-color: #007aff;\n\t\tbackground-color: #f0f8ff;\n\t}\n\n\t.visibility-icon {\n\t\tfont-size: 40rpx;\n\t\tmargin-right: 20rpx;\n\t}\n\n\t.visibility-info {\n\t\tflex: 1;\n\t}\n\n\t.visibility-name {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tfont-weight: bold;\n\t\tdisplay: block;\n\t\tmargin-bottom: 8rpx;\n\t\tline-height: 1.3;\n\t\tword-wrap: break-word;\n\t\tword-break: break-all;\n\t}\n\n\t.visibility-desc {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tdisplay: block;\n\t\tline-height: 1.3;\n\t\tword-wrap: break-word;\n\t\tword-break: break-all;\n\t}\n\n\t.team-selector,\n\t.datetime-picker {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 20rpx;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\tbackground-color: white;\n\t}\n\n\t.selector-text,\n\t.datetime-text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tflex: 1;\n\t}\n\n\t.selector-text.placeholder,\n\t.datetime-text.placeholder {\n\t\tcolor: #999;\n\t}\n\n\t.selector-arrow,\n\t.picker-arrow {\n\t\tfont-size: 24rpx;\n\t\tcolor: #999;\n\t}\n\n\t.number-input {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\toverflow: hidden;\n\t}\n\n\t.input-prefix {\n\t\tpadding: 20rpx;\n\t\tbackground-color: #f8f9fa;\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t}\n\n\t.input-unit {\n\t\tpadding: 20rpx;\n\t\tbackground-color: #f8f9fa;\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t}\n\n\t.number-input .form-input {\n\t\tborder: none;\n\t\tflex: 1;\n\t}\n\n\t.switch-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 16rpx;\n\t}\n\n\t.switch-label {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t}\n\n\t.switch-desc {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tline-height: 1.5;\n\t}\n\n\t.submit-section {\n\t\tdisplay: flex;\n\t\tgap: 20rpx;\n\t\tpadding: 0 20rpx;\n\t}\n\n\t.btn {\n\t\tflex: 1;\n\t\theight: 88rpx;\n\t\tborder-radius: 44rpx;\n\t\tfont-size: 32rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: none;\n\t}\n\n\t.btn-primary {\n\t\tbackground-color: #007aff;\n\t\tcolor: white;\n\t}\n\n\t.btn-outline {\n\t\tbackground-color: transparent;\n\t\tcolor: #007aff;\n\t\tborder: 2rpx solid #007aff;\n\t}\n\n\t/* å¼¹çª—æ ·å¼ */\n\t.modal-overlay {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tz-index: 1000;\n\t}\n\n\t.modal-content {\n\t\tbackground-color: white;\n\t\tborder-radius: 16rpx;\n\t\twidth: 90%;\n\t\tmax-width: 600rpx;\n\t\tmax-height: 80vh;\n\t\toverflow: hidden;\n\t}\n\n\t.modal-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 40rpx;\n\t\tborder-bottom: 1rpx solid #f0f0f0;\n\t}\n\n\t.modal-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t}\n\n\t.modal-close {\n\t\tfont-size: 48rpx;\n\t\tcolor: #999;\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.modal-body {\n\t\tpadding: 40rpx;\n\t\tmax-height: 60vh;\n\t\toverflow-y: auto;\n\t}\n\n\t.team-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 20rpx;\n\t}\n\n\t.team-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 30rpx;\n\t\tborder: 2rpx solid #e9ecef;\n\t\tborder-radius: 12rpx;\n\t\ttransition: all 0.3s;\n\t}\n\n\t.team-item:active {\n\t\tbackground-color: #f8f9fa;\n\t}\n\n\t.team-name {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tfont-weight: bold;\n\t}\n\n\t.team-role {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t}\n</style>\n","import MiniProgramPage from 'C:/vscode/kirojianlu/jianlu-uniapp/pages/activity-create/activity-create.vue'\nwx.createPage(MiniProgramPage)"],"names":["activityTypes","groupApi","uni","showError","activityApi","showSuccess","formatDate"],"mappings":"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"}