{"version":3,"file":"profile.js","sources":["pages/profile/profile.vue","../../../HBuilderX.4.56.2025031210/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"profile-container\">\r\n\t\t<!-- 用户信息卡片 -->\r\n\t\t<view class=\"user-card card\">\r\n\t\t\t<view class=\"user-header\">\r\n\t\t\t\t<view class=\"user-avatar\">\r\n\t\t\t\t\t<image \r\n\t\t\t\t\t\tv-if=\"userInfo.wechat_avatar || userInfo.avatar\" \r\n\t\t\t\t\t\t:src=\"userInfo.wechat_avatar || userInfo.avatar\" \r\n\t\t\t\t\t\tclass=\"avatar-image\"\r\n\t\t\t\t\t\tmode=\"aspectFill\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text v-else class=\"avatar-text\">\r\n\t\t\t\t\t\t{{ (userInfo.wechat_nickname || userInfo.nickname || userInfo.username || '').charAt(0) }}\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"user-info\">\r\n\t\t\t\t\t<text class=\"user-name\">{{ userInfo.wechat_nickname || userInfo.nickname || userInfo.username }}</text>\r\n\t\t\t\t\t<text class=\"user-email\">{{ userInfo.email }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<button class=\"edit-btn\" @tap=\"showEditModal\">\r\n\t\t\t\t\t<text class=\"edit-icon\">✏️</text>\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"user-bio\" v-if=\"userInfo.bio\">\r\n\t\t\t\t{{ userInfo.bio }}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t\t\t\r\n\t\t<!-- 功能菜单 -->\r\n\t\t<view class=\"menu-card card\">\r\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/home/home')\">\r\n\t\t\t\t<text class=\"menu-icon\">🏠</text>\r\n\t\t\t\t<text class=\"menu-text\">首页</text>\r\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/team/team')\">\r\n\t\t\t\t<text class=\"menu-icon\">👥</text>\r\n\t\t\t\t<text class=\"menu-text\">我的团队</text>\r\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/activity/activity')\">\r\n\t\t\t\t<text class=\"menu-icon\">📅</text>\r\n\t\t\t\t<text class=\"menu-text\">我的活动</text>\r\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/message/message')\">\r\n\t\t\t\t<text class=\"menu-icon\">💬</text>\r\n\t\t\t\t<text class=\"menu-text\">消息中心</text>\r\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 设置菜单 -->\r\n\t\t<view class=\"menu-card card\">\r\n\t\t\t<view class=\"menu-item\" @tap=\"showAbout\">\r\n\t\t\t\t<text class=\"menu-icon\">ℹ️</text>\r\n\t\t\t\t<text class=\"menu-text\">关于简庐团队</text>\r\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"menu-item\" @tap=\"logout\">\r\n\t\t\t\t<text class=\"menu-icon\">🚪</text>\r\n\t\t\t\t<text class=\"menu-text\">退出登录</text>\r\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 编辑资料弹窗 -->\r\n\t\t<view class=\"modal-overlay\" v-if=\"showModal\" @tap=\"hideModal\">\r\n\t\t\t<view class=\"modal-content\" @tap.stop>\r\n\t\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t\t<text class=\"modal-title\">编辑资料</text>\r\n\t\t\t\t\t<text class=\"modal-close\" @tap=\"hideModal\">×</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"modal-body\">\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"label\">昵称</text>\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\t\t\ttype=\"text\" \r\n\t\t\t\t\t\t\tplaceholder=\"输入您的昵称\"\r\n\t\t\t\t\t\t\tv-model=\"editForm.nickname\"\r\n\t\t\t\t\t\t\t:maxlength=\"50\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"label\">头像链接</text>\r\n\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\tclass=\"input\" \r\n\t\t\t\t\t\t\ttype=\"text\" \r\n\t\t\t\t\t\t\tplaceholder=\"输入头像图片链接\"\r\n\t\t\t\t\t\t\tv-model=\"editForm.avatar\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t\t<text class=\"label\">个人简介</text>\r\n\t\t\t\t\t\t<textarea \r\n\t\t\t\t\t\t\tclass=\"textarea\" \r\n\t\t\t\t\t\t\tplaceholder=\"介绍一下自己吧...\"\r\n\t\t\t\t\t\t\tv-model=\"editForm.bio\"\r\n\t\t\t\t\t\t\t:maxlength=\"500\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"modal-footer\">\r\n\t\t\t\t\t<button class=\"btn btn-secondary\" @tap=\"hideModal\">取消</button>\r\n\t\t\t\t\t<button class=\"btn btn-primary\" @tap=\"saveProfile\" :disabled=\"saving\">\r\n\t\t\t\t\t\t{{ saving ? '保存中...' : '保存' }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport { userApi } from '../../api/index.js'\r\n\timport { showSuccess, showError, showConfirm } from '../../utils/index.js'\r\n\t\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tuserInfo: {},\r\n\t\t\t\tshowModal: false,\r\n\t\t\t\tsaving: false,\r\n\t\t\t\teditForm: {\r\n\t\t\t\t\tnickname: '',\r\n\t\t\t\t\tavatar: '',\r\n\t\t\t\t\tbio: ''\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.loadUserInfo()\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.loadUserInfo()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 加载用户信息\r\n\t\t\tloadUserInfo() {\r\n\t\t\t\tthis.userInfo = uni.getStorageSync('userInfo') || {}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 显示编辑弹窗\r\n\t\t\tshowEditModal() {\r\n\t\t\t\tthis.editForm = {\r\n\t\t\t\t\tnickname: this.userInfo.nickname || '',\r\n\t\t\t\t\tavatar: this.userInfo.avatar || '',\r\n\t\t\t\t\tbio: this.userInfo.bio || ''\r\n\t\t\t\t}\r\n\t\t\t\tthis.showModal = true\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 隐藏编辑弹窗\r\n\t\t\thideModal() {\r\n\t\t\t\tthis.showModal = false\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 保存资料\r\n\t\t\tasync saveProfile() {\r\n\t\t\t\tthis.saving = true\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await userApi.updateProfile(this.editForm)\r\n\t\t\t\t\tif (response.success) {\r\n\t\t\t\t\t\t// 更新本地存储的用户信息\r\n\t\t\t\t\t\tconst updatedUserInfo = { ...this.userInfo, ...this.editForm }\r\n\t\t\t\t\t\tuni.setStorageSync('userInfo', updatedUserInfo)\r\n\t\t\t\t\t\tthis.userInfo = updatedUserInfo\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tshowSuccess('资料更新成功')\r\n\t\t\t\t\t\tthis.hideModal()\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tshowError('更新失败')\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tthis.saving = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 跳转页面\r\n\t\t\tgoToPage(url) {\r\n\t\t\t\tif (url.includes('/pages/home/home') || url.includes('/pages/team/team') || url.includes('/pages/activity/activity') || url.includes('/pages/message/message')) {\r\n\t\t\t\t\tuni.switchTab({ url })\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.navigateTo({ url })\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 显示关于信息\r\n\t\t\tshowAbout() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '关于简庐团队',\r\n\t\t\t\t\tcontent: '简庐团队 v1.0.0\\n\\n一个现代化的团队协作和活动管理平台。\\n\\n高效协作，共创未来！',\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 退出登录\r\n\t\t\tasync logout() {\r\n\t\t\t\tconst confirmed = await showConfirm('确定要退出登录吗？')\r\n\t\t\t\tif (!confirmed) return\r\n\t\t\t\t\r\n\t\t\t\t// 清除本地存储\r\n\t\t\t\tuni.removeStorageSync('token')\r\n\t\t\t\tuni.removeStorageSync('userInfo')\r\n\t\t\t\t\r\n\t\t\t\tshowSuccess('已退出登录')\r\n\t\t\t\t\r\n\t\t\t\t// 跳转到登录页\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.profile-container {\r\n\t\tpadding: 20rpx;\r\n\t\tmin-height: 100vh;\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\t\r\n\t.user-card {\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tpadding: 30rpx;\r\n\t}\r\n\t\r\n\t.user-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.user-avatar {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tborder-radius: 60rpx;\r\n\t\tbackground: #007aff;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-right: 24rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.avatar-image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tborder-radius: 60rpx;\r\n\t}\r\n\t\r\n\t.avatar-text {\r\n\t\tcolor: #ffffff;\r\n\t\tfont-size: 48rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.user-info {\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.user-name {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\t\r\n\t.user-email {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.edit-btn {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tborder-radius: 30rpx;\r\n\t\tbackground: #f0f0f0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tborder: none;\r\n\t}\r\n\t\r\n\t.edit-icon {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.user-bio {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tline-height: 1.5;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground: #f8f8f8;\r\n\t\tborder-radius: 12rpx;\r\n\t}\r\n\t\r\n\t\t\r\n\t.menu-card {\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tpadding: 0;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.menu-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-bottom: 2rpx solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.menu-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\t\r\n\t.menu-icon {\r\n\t\tfont-size: 32rpx;\r\n\t\tmargin-right: 20rpx;\r\n\t\twidth: 40rpx;\r\n\t}\r\n\t\r\n\t.menu-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t\t\r\n\t.modal-overlay {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground: rgba(0, 0, 0, 0.5);\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tz-index: 1000;\r\n\t}\r\n\t\r\n\t.modal-content {\r\n\t\twidth: 90%;\r\n\t\tmax-height: 80%;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.modal-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-bottom: 2rpx solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.modal-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.modal-close {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\t\r\n\t.modal-body {\r\n\t\tflex: 1;\r\n\t\tpadding: 30rpx;\r\n\t\toverflow-y: auto;\r\n\t}\r\n\t\r\n\t.form-item {\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.label {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 12rpx;\r\n\t}\r\n\t\r\n\t.textarea {\r\n\t\twidth: 100%;\r\n\t\theight: 120rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tborder: 2rpx solid #e0e0e0;\r\n\t\tborder-radius: 8rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\tresize: none;\r\n\t}\r\n\t\r\n\t.modal-footer {\r\n\t\tdisplay: flex;\r\n\t\tgap: 20rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-top: 2rpx solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.modal-footer .btn {\r\n\t\tflex: 1;\r\n\t\theight: 80rpx;\r\n\t\tline-height: 80rpx;\r\n\t\ttext-align: center;\r\n\t\tborder-radius: 8rpx;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'C:/D/re/kirojianlu/jianlu-uniapp/pages/profile/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","userApi","showSuccess","showError","showConfirm"],"mappings":";;;;AAiIC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU,CAAE;AAAA,MACZ,WAAW;AAAA,MACX,QAAQ;AAAA,MACR,UAAU;AAAA,QACT,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,KAAK;AAAA,MACN;AAAA,IACD;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,aAAa;AAAA,EAClB;AAAA,EACD,SAAS;AACR,SAAK,aAAa;AAAA,EAClB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,eAAe;AACd,WAAK,WAAWA,cAAAA,MAAI,eAAe,UAAU,KAAK,CAAC;AAAA,IACnD;AAAA;AAAA,IAGD,gBAAgB;AACf,WAAK,WAAW;AAAA,QACf,UAAU,KAAK,SAAS,YAAY;AAAA,QACpC,QAAQ,KAAK,SAAS,UAAU;AAAA,QAChC,KAAK,KAAK,SAAS,OAAO;AAAA,MAC3B;AACA,WAAK,YAAY;AAAA,IACjB;AAAA;AAAA,IAGD,YAAY;AACX,WAAK,YAAY;AAAA,IACjB;AAAA;AAAA,IAGD,MAAM,cAAc;AACnB,WAAK,SAAS;AACd,UAAI;AACH,cAAM,WAAW,MAAMC,UAAAA,QAAQ,cAAc,KAAK,QAAQ;AAC1D,YAAI,SAAS,SAAS;AAErB,gBAAM,kBAAkB,EAAE,GAAG,KAAK,UAAU,GAAG,KAAK,SAAS;AAC7DD,8BAAI,eAAe,YAAY,eAAe;AAC9C,eAAK,WAAW;AAEhBE,sBAAAA,YAAY,QAAQ;AACpB,eAAK,UAAU;AAAA,QAChB;AAAA,MACC,SAAO,OAAO;AACfC,oBAAAA,UAAU,MAAM;AAAA,MACjB,UAAU;AACT,aAAK,SAAS;AAAA,MACf;AAAA,IACA;AAAA;AAAA,IAGD,SAAS,KAAK;AACb,UAAI,IAAI,SAAS,kBAAkB,KAAK,IAAI,SAAS,kBAAkB,KAAK,IAAI,SAAS,0BAA0B,KAAK,IAAI,SAAS,wBAAwB,GAAG;AAC/JH,4BAAI,UAAU,EAAE,KAAK;AAAA,aACf;AACNA,4BAAI,WAAW,EAAE,KAAK;AAAA,MACvB;AAAA,IACA;AAAA;AAAA,IAGD,YAAY;AACXA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,OACZ;AAAA,IACD;AAAA;AAAA,IAGD,MAAM,SAAS;AACd,YAAM,YAAY,MAAMI,YAAW,YAAC,WAAW;AAC/C,UAAI,CAAC;AAAW;AAGhBJ,oBAAG,MAAC,kBAAkB,OAAO;AAC7BA,oBAAG,MAAC,kBAAkB,UAAU;AAEhCE,kBAAAA,YAAY,OAAO;AAGnB,iBAAW,MAAM;AAChBF,sBAAAA,MAAI,SAAS;AAAA,UACZ,KAAK;AAAA,SACL;AAAA,MACD,GAAE,GAAI;AAAA,IACR;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClOD,GAAG,WAAW,eAAe;"}