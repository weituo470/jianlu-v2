{"version":3,"file":"profile.js","sources":["pages/profile/profile.vue","../../../D/HBuilderX.4.56.2025031210/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"profile-container\">\n\t\t<!-- 用户信息卡片 -->\n\t\t<view class=\"user-card card\">\n\t\t\t<view class=\"user-header\">\n\t\t\t\t<view class=\"user-avatar\">\n\t\t\t\t\t<image \n\t\t\t\t\t\tv-if=\"userInfo.wechat_avatar || userInfo.avatar\" \n\t\t\t\t\t\t:src=\"userInfo.wechat_avatar || userInfo.avatar\" \n\t\t\t\t\t\tclass=\"avatar-image\"\n\t\t\t\t\t\tmode=\"aspectFill\"\n\t\t\t\t\t/>\n\t\t\t\t\t<text v-else class=\"avatar-text\">\n\t\t\t\t\t\t{{ (userInfo.wechat_nickname || userInfo.nickname || userInfo.username || '').charAt(0) }}\n\t\t\t\t\t</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"user-info\">\n\t\t\t\t\t<text class=\"user-name\">{{ userInfo.wechat_nickname || userInfo.nickname || userInfo.username }}</text>\n\t\t\t\t\t<text class=\"user-email\">{{ userInfo.email }}</text>\n\t\t\t\t</view>\n\t\t\t\t<button class=\"edit-btn\" @tap=\"showEditModal\">\n\t\t\t\t\t<text class=\"edit-icon\">✏️</text>\n\t\t\t\t</button>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"user-bio\" v-if=\"userInfo.bio\">\n\t\t\t\t{{ userInfo.bio }}\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t\t\t\n\t\t<!-- 功能菜单 -->\n\t\t<view class=\"menu-card card\">\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/home/home')\">\n\t\t\t\t<text class=\"menu-icon\">🏠</text>\n\t\t\t\t<text class=\"menu-text\">首页</text>\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\n\t\t\t</view>\n\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/team/team')\">\n\t\t\t\t<text class=\"menu-icon\">👥</text>\n\t\t\t\t<text class=\"menu-text\">我的团队</text>\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\n\t\t\t</view>\n\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/activity/activity')\">\n\t\t\t\t<text class=\"menu-icon\">📅</text>\n\t\t\t\t<text class=\"menu-text\">我的活动</text>\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\n\t\t\t</view>\n\n\t\t\t<view class=\"menu-item\" @tap=\"goToPage('/pages/message/message')\">\n\t\t\t\t<text class=\"menu-icon\">💬</text>\n\t\t\t\t<text class=\"menu-text\">消息中心</text>\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 设置菜单 -->\n\t\t<view class=\"menu-card card\">\n\t\t\t<view class=\"menu-item\" @tap=\"showAbout\">\n\t\t\t\t<text class=\"menu-icon\">ℹ️</text>\n\t\t\t\t<text class=\"menu-text\">关于简庐团队</text>\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\n\t\t\t</view>\n\n\t\t\t<view class=\"menu-item\" @tap=\"logout\">\n\t\t\t\t<text class=\"menu-icon\">🚪</text>\n\t\t\t\t<text class=\"menu-text\">退出登录</text>\n\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#999\"></uni-icons>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 编辑资料弹窗 -->\n\t\t<view class=\"modal-overlay\" v-if=\"showModal\" @tap=\"hideModal\">\n\t\t\t<view class=\"modal-content\" @tap.stop>\n\t\t\t\t<view class=\"modal-header\">\n\t\t\t\t\t<text class=\"modal-title\">编辑资料</text>\n\t\t\t\t\t<text class=\"modal-close\" @tap=\"hideModal\">×</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"modal-body\">\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">昵称</text>\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tplaceholder=\"输入您的昵称\"\n\t\t\t\t\t\t\tv-model=\"editForm.nickname\"\n\t\t\t\t\t\t\t:maxlength=\"50\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">头像链接</text>\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tclass=\"input\" \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tplaceholder=\"输入头像图片链接\"\n\t\t\t\t\t\t\tv-model=\"editForm.avatar\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"label\">个人简介</text>\n\t\t\t\t\t\t<textarea \n\t\t\t\t\t\t\tclass=\"textarea\" \n\t\t\t\t\t\t\tplaceholder=\"介绍一下自己吧...\"\n\t\t\t\t\t\t\tv-model=\"editForm.bio\"\n\t\t\t\t\t\t\t:maxlength=\"500\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"modal-footer\">\n\t\t\t\t\t<button class=\"btn btn-secondary\" @tap=\"hideModal\">取消</button>\n\t\t\t\t\t<button class=\"btn btn-primary\" @tap=\"saveProfile\" :disabled=\"saving\">\n\t\t\t\t\t\t{{ saving ? '保存中...' : '保存' }}\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport { userApi } from '../../api/index.js'\n\timport { showSuccess, showError, showConfirm } from '../../utils/index.js'\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tuserInfo: {},\n\t\t\t\tshowModal: false,\n\t\t\t\tsaving: false,\n\t\t\t\teditForm: {\n\t\t\t\t\tnickname: '',\n\t\t\t\t\tavatar: '',\n\t\t\t\t\tbio: ''\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonLoad() {\n\t\t\tthis.loadUserInfo()\n\t\t},\n\t\tonShow() {\n\t\t\tthis.loadUserInfo()\n\t\t},\n\t\tmethods: {\n\t\t\t// 加载用户信息\n\t\t\tloadUserInfo() {\n\t\t\t\tthis.userInfo = uni.getStorageSync('userInfo') || {}\n\t\t\t},\n\t\t\t\n\t\t\t// 显示编辑弹窗\n\t\t\tshowEditModal() {\n\t\t\t\tthis.editForm = {\n\t\t\t\t\tnickname: this.userInfo.nickname || '',\n\t\t\t\t\tavatar: this.userInfo.avatar || '',\n\t\t\t\t\tbio: this.userInfo.bio || ''\n\t\t\t\t}\n\t\t\t\tthis.showModal = true\n\t\t\t},\n\t\t\t\n\t\t\t// 隐藏编辑弹窗\n\t\t\thideModal() {\n\t\t\t\tthis.showModal = false\n\t\t\t},\n\t\t\t\n\t\t\t// 保存资料\n\t\t\tasync saveProfile() {\n\t\t\t\tthis.saving = true\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await userApi.updateProfile(this.editForm)\n\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t// 更新本地存储的用户信息\n\t\t\t\t\t\tconst updatedUserInfo = { ...this.userInfo, ...this.editForm }\n\t\t\t\t\t\tuni.setStorageSync('userInfo', updatedUserInfo)\n\t\t\t\t\t\tthis.userInfo = updatedUserInfo\n\t\t\t\t\t\t\n\t\t\t\t\t\tshowSuccess('资料更新成功')\n\t\t\t\t\t\tthis.hideModal()\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tshowError('更新失败')\n\t\t\t\t} finally {\n\t\t\t\t\tthis.saving = false\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 跳转页面\n\t\t\tgoToPage(url) {\n\t\t\t\tif (url.includes('/pages/home/home') || url.includes('/pages/team/team') || url.includes('/pages/activity/activity') || url.includes('/pages/message/message')) {\n\t\t\t\t\tuni.switchTab({ url })\n\t\t\t\t} else {\n\t\t\t\t\tuni.navigateTo({ url })\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 显示关于信息\n\t\t\tshowAbout() {\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '关于简庐团队',\n\t\t\t\t\tcontent: '简庐团队 v1.0.0\\n\\n一个现代化的团队协作和活动管理平台。\\n\\n高效协作，共创未来！',\n\t\t\t\t\tshowCancel: false\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// 退出登录\n\t\t\tasync logout() {\n\t\t\t\tconst confirmed = await showConfirm('确定要退出登录吗？')\n\t\t\t\tif (!confirmed) return\n\t\t\t\t\n\t\t\t\t// 清除本地存储\n\t\t\t\tuni.removeStorageSync('token')\n\t\t\t\tuni.removeStorageSync('userInfo')\n\t\t\t\t\n\t\t\t\tshowSuccess('已退出登录')\n\t\t\t\t\n\t\t\t\t// 跳转到登录页\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.reLaunch({\n\t\t\t\t\t\turl: '/pages/login/login'\n\t\t\t\t\t})\n\t\t\t\t}, 1000)\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.profile-container {\n\t\tpadding: 20rpx;\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f5f5f5;\n\t}\n\t\n\t.user-card {\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 30rpx;\n\t}\n\t\n\t.user-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.user-avatar {\n\t\twidth: 120rpx;\n\t\theight: 120rpx;\n\t\tborder-radius: 60rpx;\n\t\tbackground: #007aff;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-right: 24rpx;\n\t\toverflow: hidden;\n\t}\n\t\n\t.avatar-image {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 60rpx;\n\t}\n\t\n\t.avatar-text {\n\t\tcolor: #ffffff;\n\t\tfont-size: 48rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.user-info {\n\t\tflex: 1;\n\t}\n\t\n\t.user-name {\n\t\tfont-size: 36rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t\tdisplay: block;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.user-email {\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t\tdisplay: block;\n\t}\n\t\n\t.edit-btn {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tborder-radius: 30rpx;\n\t\tbackground: #f0f0f0;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: none;\n\t}\n\t\n\t.edit-icon {\n\t\tfont-size: 28rpx;\n\t}\n\t\n\t.user-bio {\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t\tline-height: 1.5;\n\t\tpadding: 20rpx;\n\t\tbackground: #f8f8f8;\n\t\tborder-radius: 12rpx;\n\t}\n\t\n\t\t\n\t.menu-card {\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 0;\n\t\toverflow: hidden;\n\t}\n\t\n\t.menu-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 30rpx;\n\t\tborder-bottom: 2rpx solid #f0f0f0;\n\t}\n\t\n\t.menu-item:last-child {\n\t\tborder-bottom: none;\n\t}\n\t\n\t.menu-icon {\n\t\tfont-size: 32rpx;\n\t\tmargin-right: 20rpx;\n\t\twidth: 40rpx;\n\t}\n\t\n\t.menu-text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tflex: 1;\n\t}\n\t\n\t\t\n\t.modal-overlay {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tz-index: 1000;\n\t}\n\t\n\t.modal-content {\n\t\twidth: 90%;\n\t\tmax-height: 80%;\n\t\tbackground: #ffffff;\n\t\tborder-radius: 16rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.modal-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 30rpx;\n\t\tborder-bottom: 2rpx solid #f0f0f0;\n\t}\n\t\n\t.modal-title {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.modal-close {\n\t\tfont-size: 40rpx;\n\t\tcolor: #999;\n\t}\n\t\n\t.modal-body {\n\t\tflex: 1;\n\t\tpadding: 30rpx;\n\t\toverflow-y: auto;\n\t}\n\t\n\t.form-item {\n\t\tmargin-bottom: 30rpx;\n\t}\n\t\n\t.label {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tmargin-bottom: 12rpx;\n\t}\n\t\n\t.textarea {\n\t\twidth: 100%;\n\t\theight: 120rpx;\n\t\tpadding: 20rpx;\n\t\tborder: 2rpx solid #e0e0e0;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 28rpx;\n\t\tbox-sizing: border-box;\n\t\tresize: none;\n\t}\n\t\n\t.modal-footer {\n\t\tdisplay: flex;\n\t\tgap: 20rpx;\n\t\tpadding: 30rpx;\n\t\tborder-top: 2rpx solid #f0f0f0;\n\t}\n\t\n\t.modal-footer .btn {\n\t\tflex: 1;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\ttext-align: center;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 28rpx;\n\t}\n</style>\n","import MiniProgramPage from 'C:/vscode/kirojianlu/jianlu-uniapp/pages/profile/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","userApi","showSuccess","showError","showConfirm"],"mappings":";;;;AAiIC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU,CAAE;AAAA,MACZ,WAAW;AAAA,MACX,QAAQ;AAAA,MACR,UAAU;AAAA,QACT,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,KAAK;AAAA,MACN;AAAA,IACD;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,aAAa;AAAA,EAClB;AAAA,EACD,SAAS;AACR,SAAK,aAAa;AAAA,EAClB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,eAAe;AACd,WAAK,WAAWA,cAAAA,MAAI,eAAe,UAAU,KAAK,CAAC;AAAA,IACnD;AAAA;AAAA,IAGD,gBAAgB;AACf,WAAK,WAAW;AAAA,QACf,UAAU,KAAK,SAAS,YAAY;AAAA,QACpC,QAAQ,KAAK,SAAS,UAAU;AAAA,QAChC,KAAK,KAAK,SAAS,OAAO;AAAA,MAC3B;AACA,WAAK,YAAY;AAAA,IACjB;AAAA;AAAA,IAGD,YAAY;AACX,WAAK,YAAY;AAAA,IACjB;AAAA;AAAA,IAGD,MAAM,cAAc;AACnB,WAAK,SAAS;AACd,UAAI;AACH,cAAM,WAAW,MAAMC,UAAAA,QAAQ,cAAc,KAAK,QAAQ;AAC1D,YAAI,SAAS,SAAS;AAErB,gBAAM,kBAAkB,EAAE,GAAG,KAAK,UAAU,GAAG,KAAK,SAAS;AAC7DD,8BAAI,eAAe,YAAY,eAAe;AAC9C,eAAK,WAAW;AAEhBE,sBAAAA,YAAY,QAAQ;AACpB,eAAK,UAAU;AAAA,QAChB;AAAA,MACC,SAAO,OAAO;AACfC,oBAAAA,UAAU,MAAM;AAAA,MACjB,UAAU;AACT,aAAK,SAAS;AAAA,MACf;AAAA,IACA;AAAA;AAAA,IAGD,SAAS,KAAK;AACb,UAAI,IAAI,SAAS,kBAAkB,KAAK,IAAI,SAAS,kBAAkB,KAAK,IAAI,SAAS,0BAA0B,KAAK,IAAI,SAAS,wBAAwB,GAAG;AAC/JH,4BAAI,UAAU,EAAE,KAAK;AAAA,aACf;AACNA,4BAAI,WAAW,EAAE,KAAK;AAAA,MACvB;AAAA,IACA;AAAA;AAAA,IAGD,YAAY;AACXA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,OACZ;AAAA,IACD;AAAA;AAAA,IAGD,MAAM,SAAS;AACd,YAAM,YAAY,MAAMI,YAAW,YAAC,WAAW;AAC/C,UAAI,CAAC;AAAW;AAGhBJ,oBAAG,MAAC,kBAAkB,OAAO;AAC7BA,oBAAG,MAAC,kBAAkB,UAAU;AAEhCE,kBAAAA,YAAY,OAAO;AAGnB,iBAAW,MAAM;AAChBF,sBAAAA,MAAI,SAAS;AAAA,UACZ,KAAK;AAAA,SACL;AAAA,MACD,GAAE,GAAI;AAAA,IACR;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClOD,GAAG,WAAW,eAAe;"}