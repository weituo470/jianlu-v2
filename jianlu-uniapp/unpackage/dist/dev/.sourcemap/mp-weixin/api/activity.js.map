{"version":3,"file":"activity.js","sources":["api/activity.js"],"sourcesContent":["import { get, post, put, del } from '../utils/request.js'\r\n\r\n// æ´»åŠ¨APIæ¥å£ï¼ˆä½¿ç”¨å°ç¨‹åºä¸“ç”¨APIï¼‰\r\nexport const activityApi = {\r\n  // è·å–æ´»åŠ¨åˆ—è¡¨\r\n  getList(params = {}) {\r\n    return get('/miniapp/activities', params)\r\n  },\r\n\r\n  // è·å–æ´»åŠ¨è¯¦æƒ…\r\n  getDetail(id) {\r\n    return get(`/miniapp/activities/${id}`)\r\n  },\r\n\r\n  // åˆ›å»ºæ´»åŠ¨\r\n  create(data) {\r\n    return post('/miniapp/activities', data)\r\n  },\r\n\r\n  // æ›´æ–°æ´»åŠ¨\r\n  update(id, data) {\r\n    return put(`/miniapp/activities/${id}`, data)\r\n  },\r\n\r\n  // åˆ é™¤æ´»åŠ¨\r\n  delete(id) {\r\n    return del(`/miniapp/activities/${id}`)\r\n  },\r\n\r\n  // æŠ¥åæ´»åŠ¨\r\n  register(id, data) {\r\n    return post(`/miniapp/activities/${id}/register`, data)\r\n  },\r\n\r\n  // å–æ¶ˆæŠ¥å\r\n  cancelRegistration(id) {\r\n    return del(`/miniapp/activities/${id}/register`)\r\n  },\r\n\r\n  // è·å–æˆ‘çš„æŠ¥ååˆ—è¡¨\r\n  getMyRegistrations(params = {}) {\r\n    return get('/miniapp/my-registrations', params)\r\n  },\r\n\r\n  // è·å–æ´»åŠ¨æŠ¥ååˆ—è¡¨ï¼ˆç®¡ç†å‘˜ï¼‰\r\n  getRegistrations(id, params = {}) {\r\n    return get(`/miniapp/activities/${id}/registrations`, params)\r\n  },\r\n\r\n  // å®¡æ ¸æŠ¥åï¼ˆç®¡ç†å‘˜ï¼‰\r\n  approveRegistration(registrationId, approved = true) {\r\n    return post(`/miniapp/registrations/${registrationId}/approve`, { approved })\r\n  },\r\n\r\n  // æ‰¹é‡å®¡æ ¸æŠ¥åï¼ˆç®¡ç†å‘˜ï¼‰\r\n  batchApproveRegistrations(registrationIds, approved = true) {\r\n    return post('/miniapp/registrations/batch-approve', { \r\n      registration_ids: registrationIds, \r\n      approved \r\n    })\r\n  }\r\n}\r\n\r\n// æ´»åŠ¨ç±»å‹é…ç½®\r\nexport const activityTypes = {\r\n  travel: {\r\n    name: 'æ—…æ¸¸æ´»åŠ¨',\r\n    icon: 'ğŸ–ï¸',\r\n    color: '#FF6B6B',\r\n    description: 'å›¢å»ºæ—…è¡Œã€æˆ·å¤–æ¢é™©ç­‰'\r\n  },\r\n  meeting: {\r\n    name: 'ä¼šè®®æ´»åŠ¨', \r\n    icon: 'ğŸ’¼',\r\n    color: '#4ECDC4',\r\n    description: 'æŠ€æœ¯åˆ†äº«ã€å·¥ä½œä¼šè®®ç­‰'\r\n  },\r\n  social: {\r\n    name: 'ç¤¾äº¤æ´»åŠ¨',\r\n    icon: 'ğŸ‰',\r\n    color: '#45B7D1',\r\n    description: 'èšé¤ã€å¨±ä¹ç­‰'\r\n  },\r\n  learning: {\r\n    name: 'å­¦ä¹ æ´»åŠ¨',\r\n    icon: 'ğŸ“š',\r\n    color: '#96CEB4',\r\n    description: 'åŸ¹è®­ã€è®²åº§ç­‰'\r\n  },\r\n  sports: {\r\n    name: 'è¿åŠ¨æ´»åŠ¨',\r\n    icon: 'âš½',\r\n    color: '#FFEAA7',\r\n    description: 'å¥èº«ã€æ¯”èµ›ç­‰'\r\n  },\r\n  other: {\r\n    name: 'å…¶å®ƒ',\r\n    icon: 'ğŸ“‹',\r\n    color: '#BDC3C7',\r\n    description: 'å…¶å®ƒç±»å‹çš„æ´»åŠ¨'\r\n  }\r\n}\r\n\r\n// æ´»åŠ¨çŠ¶æ€é…ç½®\r\nexport const activityStatus = {\r\n  draft: {\r\n    name: 'è‰ç¨¿',\r\n    color: '#BDC3C7',\r\n    description: 'æ´»åŠ¨å°šæœªå‘å¸ƒ'\r\n  },\r\n  registration: {\r\n    name: 'æŠ¥åä¸­',\r\n    color: '#3498DB',\r\n    description: 'æ­£åœ¨æ¥å—æŠ¥å'\r\n  },\r\n  ongoing: {\r\n    name: 'è¿›è¡Œä¸­',\r\n    color: '#2ECC71',\r\n    description: 'æ´»åŠ¨æ­£åœ¨è¿›è¡Œ'\r\n  },\r\n  completed: {\r\n    name: 'å·²ç»“æŸ',\r\n    color: '#95A5A6',\r\n    description: 'æ´»åŠ¨å·²ç»ç»“æŸ'\r\n  },\r\n  cancelled: {\r\n    name: 'å·²å–æ¶ˆ',\r\n    color: '#E74C3C',\r\n    description: 'æ´»åŠ¨å·²è¢«å–æ¶ˆ'\r\n  }\r\n}\r\n\r\n// æŠ¥åçŠ¶æ€é…ç½®\r\nexport const registrationStatus = {\r\n  pending: {\r\n    name: 'å¾…å®¡æ ¸',\r\n    color: '#F39C12',\r\n    description: 'ç­‰å¾…ç®¡ç†å‘˜å®¡æ ¸'\r\n  },\r\n  approved: {\r\n    name: 'å·²é€šè¿‡',\r\n    color: '#27AE60',\r\n    description: 'æŠ¥åå·²é€šè¿‡'\r\n  },\r\n  rejected: {\r\n    name: 'å·²æ‹’ç»',\r\n    color: '#E74C3C',\r\n    description: 'æŠ¥åè¢«æ‹’ç»'\r\n  },\r\n  cancelled: {\r\n    name: 'å·²å–æ¶ˆ',\r\n    color: '#95A5A6',\r\n    description: 'ç”¨æˆ·å–æ¶ˆæŠ¥å'\r\n  },\r\n  waitlist: {\r\n    name: 'ç­‰å¾…åˆ—è¡¨',\r\n    color: '#8E44AD',\r\n    description: 'åœ¨ç­‰å¾…åˆ—è¡¨ä¸­'\r\n  }\r\n}\r\n\r\n// æ´»åŠ¨å¯è§æ€§é…ç½®\r\nexport const activityVisibility = {\r\n  public: {\r\n    name: 'å…¬å¼€æ´»åŠ¨',\r\n    icon: 'ğŸŒ',\r\n    description: 'æ‰€æœ‰ç”¨æˆ·å¯è§'\r\n  },\r\n  team: {\r\n    name: 'å›¢é˜Ÿæ´»åŠ¨',\r\n    icon: 'ğŸ‘¥',\r\n    description: 'ä»…å›¢é˜Ÿæˆå‘˜å¯è§'\r\n  }\r\n}\r\n\r\n// å·¥å…·å‡½æ•°\r\nexport const activityUtils = {\r\n  // è·å–æ´»åŠ¨ç±»å‹ä¿¡æ¯\r\n  getTypeInfo(type) {\r\n    return activityTypes[type] || { name: 'æœªçŸ¥ç±»å‹', icon: 'â“', color: '#BDC3C7' }\r\n  },\r\n\r\n  // è·å–æ´»åŠ¨çŠ¶æ€ä¿¡æ¯\r\n  getStatusInfo(status) {\r\n    return activityStatus[status] || { name: 'æœªçŸ¥çŠ¶æ€', color: '#BDC3C7' }\r\n  },\r\n\r\n  // è·å–æŠ¥åçŠ¶æ€ä¿¡æ¯\r\n  getRegistrationStatusInfo(status) {\r\n    return registrationStatus[status] || { name: 'æœªçŸ¥çŠ¶æ€', color: '#BDC3C7' }\r\n  },\r\n\r\n  // è·å–å¯è§æ€§ä¿¡æ¯\r\n  getVisibilityInfo(visibility) {\r\n    return activityVisibility[visibility] || { name: 'æœªçŸ¥', icon: 'â“' }\r\n  },\r\n\r\n  // æ ¼å¼åŒ–æ´»åŠ¨æ—¶é—´\r\n  formatActivityTime(startTime, endTime) {\r\n    const start = new Date(startTime)\r\n    const end = new Date(endTime)\r\n    const now = new Date()\r\n\r\n    const formatDate = (date) => {\r\n      const year = date.getFullYear()\r\n      const month = String(date.getMonth() + 1).padStart(2, '0')\r\n      const day = String(date.getDate()).padStart(2, '0')\r\n      const hour = String(date.getHours()).padStart(2, '0')\r\n      const minute = String(date.getMinutes()).padStart(2, '0')\r\n      \r\n      return `${year}-${month}-${day} ${hour}:${minute}`\r\n    }\r\n\r\n    const isSameDay = start.toDateString() === end.toDateString()\r\n    \r\n    if (isSameDay) {\r\n      return `${formatDate(start)} - ${end.getHours().toString().padStart(2, '0')}:${end.getMinutes().toString().padStart(2, '0')}`\r\n    } else {\r\n      return `${formatDate(start)} - ${formatDate(end)}`\r\n    }\r\n  },\r\n\r\n  // æ£€æŸ¥æ´»åŠ¨æ˜¯å¦å¯ä»¥æŠ¥å\r\n  canRegister(activity) {\r\n    const now = new Date()\r\n    const registrationDeadline = activity.registration_deadline ? new Date(activity.registration_deadline) : null\r\n    \r\n    // æ£€æŸ¥æ´»åŠ¨çŠ¶æ€\r\n    if (activity.status !== 'registration') {\r\n      return { canRegister: false, reason: 'æ´»åŠ¨æœªå¼€æ”¾æŠ¥å' }\r\n    }\r\n\r\n    // æ£€æŸ¥æŠ¥åæˆªæ­¢æ—¶é—´\r\n    if (registrationDeadline && now > registrationDeadline) {\r\n      return { canRegister: false, reason: 'æŠ¥åå·²æˆªæ­¢' }\r\n    }\r\n\r\n    // æ£€æŸ¥äººæ•°é™åˆ¶\r\n    if (activity.max_participants > 0 && activity.registration_count >= activity.max_participants) {\r\n      return { canRegister: false, reason: 'æŠ¥åäººæ•°å·²æ»¡' }\r\n    }\r\n\r\n    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²æŠ¥å\r\n    if (activity.user_registered) {\r\n      return { canRegister: false, reason: 'å·²ç»æŠ¥å' }\r\n    }\r\n\r\n    return { canRegister: true }\r\n  },\r\n\r\n  // è·å–æ´»åŠ¨è¿›åº¦ç™¾åˆ†æ¯”\r\n  getProgressPercentage(activity) {\r\n    if (!activity.max_participants || activity.max_participants <= 0) {\r\n      return 0 // æ— é™åˆ¶æ—¶ä¸æ˜¾ç¤ºè¿›åº¦\r\n    }\r\n\r\n    const percentage = (activity.registration_count / activity.max_participants) * 100\r\n    // ä½¿ç”¨ Math.floor ç¡®ä¿åªè¿”å›æ•´æ•°éƒ¨åˆ†\r\n    return Math.floor(Math.min(percentage, 100))\r\n  }\r\n}\r\n"],"names":["get","post","put","del"],"mappings":"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"}