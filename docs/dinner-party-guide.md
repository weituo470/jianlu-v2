# 聚餐活动功能使用指南

## 功能概述
聚餐活动功能是简庐团队系统为满足公司领导组织周末聚餐需求而设计的专项功能。该功能支持公司提供固定经费，参与人数限制，以及超出预算的AA制分摊。

## 适用场景
- 公司领导组织周末聚餐活动
- 公司提供固定经费支持
- 需要控制参与人数（5-10人）
- 超出预算部分由参与成员AA制分摊

## 使用步骤

### 1. 创建聚餐活动
1. 登录系统，进入"创建聚餐活动"页面
2. 选择要组织聚餐的团队（必须是已创建的公司团队）
3. 填写活动基本信息：
   - 活动标题
   - 活动描述
   - 活动时间
   - 活动地点
4. 设置参与限制：
   - 最少参与人数：5人
   - 最多参与人数：10人
5. 配置费用信息：
   - 公司预算：默认1000元
   - 预估总费用
   - 费用说明（可选）
6. 查看费用分摊预览
7. 点击"创建活动"完成创建

### 2. 费用分摊计算
系统会自动计算费用分摊情况：
- **公司承担部分**：预估总费用与公司预算中的较小值
- **个人AA部分**：超出公司预算的部分由参与人员均摊
- **每人AA金额**：个人AA部分 ÷ 参与人数

**示例**：
- 公司预算：1000元
- 预估总费用：1500元
- 参与人数：8人
- 分摊结果：
  - 公司承担：1000元
  - 个人AA总额：500元
  - 每人AA：62.5元

### 3. 活动发布和报名
1. 创建完成后，活动自动发布
2. 团队成员可以查看并报名参加
3. 系统实时监控报名人数
4. 当报名人数达到10人时，停止接受新的报名

### 4. 自动取消机制
系统会在以下情况自动取消活动：
- **报名人数不足**：在报名截止时间，如果报名人数少于5人
- **活动取消通知**：系统会自动通知已报名的用户

### 5. 活动进行中
- 活动组织者可以查看参与人员名单
- 可以更新实际费用信息
- 系统根据实际费用重新计算分摊金额

## 注意事项

### 人数限制
- **最少5人**：低于5人活动自动取消
- **最多10人**：超过10人的报名无效
- 建议设置合适的报名截止时间

### 费用管理
- 公司预算不可超过设定的限额
- 预估费用应尽量准确，避免后续调整
- 实际费用超出预算部分由参与人员AA制分摊

### 活动取消
- 活动取消后，所有报名用户会收到通知
- 取消的活动不可恢复，需要重新创建

## 常见问题

### Q: 如何修改已创建的聚餐活动？
A: 在活动开始前，组织者可以修改活动信息，但无法修改人数限制和公司预算。

### Q: 如果实际费用与预估费用不同怎么办？
A: 组织者可以在活动进行中更新实际费用，系统会重新计算分摊金额。

### Q: 报名后可以取消吗？
A: 用户可以在报名截止前取消报名，系统会自动通知候补人员。

### Q: 活动取消后如何处理？
A: 活动取消后，所有报名用户会收到通知，组织员可以选择重新创建活动。

## API接口说明

### 创建聚餐活动
```
POST /api/activities/dinner-party
Content-Type: application/json

{
  "title": "周末聚餐活动",
  "description": "公司周末聚餐",
  "team_id": "team-uuid",
  "start_time": "2024-01-20T18:00:00Z",
  "end_time": "2024-01-20T21:00:00Z",
  "location": "餐厅地址",
  "min_participants": 5,
  "max_participants": 10,
  "company_budget": 1000,
  "total_cost": 1500,
  "cost_description": "晚餐费用"
}
```

### 获取聚餐活动详情
```
GET /api/activities/dinner-party/:id
```

### 检查活动是否需要取消
```
POST /api/activities/dinner-party/:id/check-cancel
```

### 获取可用聚餐活动
```
GET /api/activities/dinner-party/available
```

## 最佳实践

### 1. 活动策划
- 提前规划活动时间和地点
- 选择适合团队规模的餐厅
- 合理预估人均费用

### 2. 预算设置
- 根据公司政策设置合理的预算
- 考虑餐厅的实际消费水平
- 预留一定的费用缓冲

### 3. 人数管理
- 及时关注报名情况
- 必要时可以手动调整参与名单
- 确保最终参与人数在5-10人之间

### 4. 费用透明
- 活动前明确费用分摊规则
- 活动后及时公布实际费用
- 保持费用信息的透明度

## 技术支持
如遇到技术问题，请联系系统管理员或开发团队。