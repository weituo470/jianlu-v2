# 聚餐活动功能使用说明

## 功能概述

本系统为团队领导提供了便捷的聚餐活动组织功能，支持公司预算管理、人数限制控制、自动取消机制以及费用AA分摊等特性。

## 核心特性

### 🎯 自动人数控制
- **最低人数限制**：当报名人数低于设定值时，活动自动取消
- **最高人数限制**：超过最大人数的报名自动视为无效
- **灵活取消条件**：可选择仅检查最低人数、仅检查最高人数，或两者都检查

### 💰 智能费用管理
- **公司预算控制**：设置公司承担的最高费用
- **AA分摊计算**：超出预算部分自动计算每人分摊金额
- **实时费用预览**：创建活动时即可看到费用分摊明细

### 🚀 便捷操作流程
- **团队选择**：自动加载用户有权限的团队
- **智能时间设置**：默认推荐下个周末时间
- **草稿保存**：支持保存草稿，稍后继续编辑

## 使用流程

### 1. 创建聚餐活动

#### 步骤1：进入创建页面
- 从"活动"页面点击"创建活动"
- 选择"创建聚餐活动"类型

#### 步骤2：填写基本信息
- **聚餐标题**：输入活动名称（必填）
- **聚餐描述**：详细说明活动安排（选填）
- **选择团队**：选择要组织活动的团队（必填）

#### 步骤3：设置时间地点
- **聚餐时间**：选择日期和开始时间
- **聚餐地点**：输入具体地址（必填）

#### 步骤4：配置人数限制
- **最少参与人数**：设置活动开展的最低人数要求
- **最多参与人数**：设置活动人数上限
- **自动取消条件**：选择人数检查规则

#### 步骤5：设置费用信息
- **公司预算**：输入公司承担的最高费用
- **预计总费用**：输入活动预计总费用
- **费用说明**：详细说明费用构成（选填）

#### 步骤6：发布活动
- **保存草稿**：保存当前进度，稍后继续编辑
- **发布活动**：立即发布活动，开始接受报名

### 2. 费用分摊规则

#### 计算逻辑
```
公司承担部分 = min(预计总费用, 公司预算)
员工承担部分 = 预计总费用 - 公司承担部分
每人AA费用 = 员工承担部分 / 实际参与人数
```

#### 示例场景
- **场景1**：预算充足
  - 公司预算：1000元
  - 预计总费用：800元
  - 结果：公司承担800元，员工无需AA

- **场景2**：需要AA
  - 公司预算：1000元
  - 预计总费用：1200元
  - 参与人数：8人
  - 结果：公司承担1000元，员工AA 200元，每人25元

### 3. 自动取消机制

#### 取消条件
- **人数不足**：报名人数 < 最少参与人数
- **人数超额**：报名人数 > 最多参与人数（当设置为检查时）

#### 取消时机
系统会在以下情况自动检查并取消活动：
- 活动报名截止时
- 管理员手动检查时
- 定时任务执行时

## 权限要求

### 创建权限
- 必须是团队成员
- 需要具备活动创建权限
- 通常由团队负责人或管理员拥有

### 参与权限
- 必须是团队成员
- 活动状态为"已发布"
- 未达到人数上限
- 未超过报名截止时间

## 技术特性

### 数据安全
- 所有费用数据加密存储
- 权限严格控制，确保数据安全
- 操作日志完整记录

### 性能优化
- 实时费用计算，即时反馈
- 人数检查高效算法
- 数据库索引优化

### 扩展性
- 支持多种活动特殊类型
- 费用计算规则可配置
- 权限系统灵活配置

## 常见问题

### Q1: 如何修改已发布的聚餐活动？
A1: 目前系统支持修改草稿状态的活动，已发布的活动需要取消后重新创建。

### Q2: 自动取消后如何通知参与者？
A2: 系统会自动发送通知给所有已报名的用户，说明取消原因。

### Q3: 可以设置多个团队共同参与吗？
A3: 当前版本仅支持单个团队，后续版本会考虑支持多团队协作。

### Q4: 费用计算支持更复杂的规则吗？
A4: 当前采用简单的超额AA分摊，后续版本会支持更复杂的费用计算规则。

## 最佳实践

### 设置合理的参数
- **预算设置**：根据团队规模和消费水平合理设置
- **人数限制**：考虑场地容量和活动效果
- **时间安排**：提前足够时间让大家安排日程

### 清晰的费用说明
- 详细列出费用包含项目
- 说明额外的可能支出
- 明确支付方式和时间

### 及时沟通
- 发布后及时通知团队成员
- 活动前再次确认参与情况
- 活动后收集反馈意见

## 版本历史

### v1.0.0 (当前版本)
- ✅ 基础聚餐活动创建功能
- ✅ 公司预算和AA分摊计算
- ✅ 自动人数检查和取消
- ✅ 团队权限控制
- ✅ 费用实时预览

### 计划中的功能
- 📋 活动报名管理
- 📊 费用统计报表
- 🔔 智能通知系统
- 📱 移动端优化
- 🌐 多团队协作

## 联系支持

如遇到问题或有改进建议，请联系：
- 技术支持：support@jianlu.com
- 产品反馈：feedback@jianlu.com
- 紧急联系：admin@jianlu.com

---

*最后更新时间：2025年1月*